



<!--
'
'                                                 ,:                                      
'                                                ^8>                                      
'                                               }$$<                                      
'                                              v$$$>                                      
'                                             L$$$$<                                      
'                                            q$$$$$>                                      
'                        Q$$$$$$$$i        ;W$$$$$$$$$$$$$Z      x$$$$$$$$                
'                        Q$$$$$$$$i       <$$$$$$$$$$$$$$X       x$$$$$$$$                
'                        Q$$$$$$$$i      -@$$$$$$$$$$$$$1        x$$$$$$$$                
'                        Q$$$$$$$$i     (B@B@@$@$$$$$$8;         x$$$$$$$$                
'                        Q$$$$$$$$i             O$$$$a"          x$$$$$$$$                
'                        Q$$$$$$$$i   I         Q$$$p        ,   x$$$$$$$$                
'                        Q$$$$$$$$i YB$W]       C$$c       U$$#: x$$$$$$$$                
'                        Q$$$$$$$$m$$$$$$$(     J@]     :Z$$$$$$@O$$$$$$$$                
'                        Q$$$$$$$$$$$$$$$$$@n   x:    Io$$$$$$$$$$$$$$$$$$                
'                        Q$$$$$$$$$$$$$$$$$$$$J",   >*$$$$$$$$$$$$$$$$$$$@                
'                        ^*$$$$$$$$$$$$$$$$$$$$$q }%$$$$$$$$$$$$$$$$$$$$$n                
'                         :a$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@|                 
'                           c$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&:                  
'                            -B$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$k"                   
'                              a$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$v                     
'                               C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$-                      
'                                ($$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$a^                       
                                                                              
                                                                              
                                                                              
                                                                              
'        ...                           s                      ..                 .x+=:.        s    
'     xH88"`~ .x8X                    :8                x .d88"    ..           z`    ^%      :8    
'   :8888   .f"8888Hf                .88                 5888R    @L               .   <k    .88    
'  :8888>  X8L  ^""`        u       :888ooo       u      '888R   9888i   .dL     .@8Ned8"   :888ooo 
'  X8888  X888h          us888u.  -*8888888    us888u.    888R   `Y888k:*888.  .@^%8888"  -*8888888 
'  88888  !88888.     .@88 "8888"   8888    .@88 "8888"   888R     888E  888I x88:  `)8b.   8888    
'  8b888   %a8888     9n88  9u88    8c88    9h88  9a88    8n8R     8d8E  8a8I 8888N=r8888   8k88    
'  8v888 '> `8e88>    9d88  9a88    8n88    9a88  9r88    8a8R     8y8E  8a8I  %n"    Ra8   8n88    
'  `8888L %  ?888   ! 9888  9888   .8888Lu= 9888  9888    888R     888E  888I   @8Wou 9%   .8888Lu= 
'   `8888  `-*""   /  9888  9888   ^%888*   9888  9888   .888B .  x888N><888' .888888P`    ^%888*   
'     "888.      :"   "888*""888"    'Y"    "888*""888"  ^*888%    "88"  888  `   ^"F        'Y"    
'       `""***~"`      ^Y"   ^Y'             ^Y"   ^Y'     "%            88F                        
'                                                                       98"                         
'                                                                     ./"                           
'                                                                    ~`                      
Stitched by
                                                                                                                                                           
'  88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 
'  88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 
'       ...     ..                                                                                                  ..                                      ..       
'    .=*8888x <"?88h.                                                        .uef^"                               ay                                  < .anK"`       
'   X>  '8888H> '8888                  e.    d.      a.    .               :d88E                      a.    r.   '88bu.                     .n    .    !@88E         
'  '88h. `8888   8888         v      x@88k u@88c.  .@88k  z88u         .   `888E             n      x@88k u@88c. '*88888bu         a      .d88B :@8c   '888E   u     
'  '8888 '8888    "88>     us888u.  ^"8888""8888" ~"8888 ^8888    .udR88N   888E .z8k     us888u.  ^"8888""8888"   ^"*8888N     us888u.  ="8888f8888r   888E u@8NL   
'   `888 '8888.xH888x.  .@88 "8888"   8888  888R    8888  888R   <888'888k  888E~?888L .@88 "8888"   8888  888R   beWE "888L .@88 "8888"   4888>'88"    888E`"88*"   
'     X" :88*~  `*8888> 9888  9888    8888  888R    8888  888R   9888 'Y"   888E  888E 9888  9888    8888  888R   888E  888E 9888  9888    4888> '      888E .dN.    
'   ~"   !"`      "888> 9888  9888    8888  888R    8888  888R   9888       888E  888E 9888  9888    8888  888R   888E  888E 9888  9888    4888>        888E~8888    
'    .H8888h.      ?88  9888  9888    8888  888R    8888 ,888B . 9888       888E  888E 9888  9888    8888  888R   888E  888F 9888  9888   .d888L .+     888E '888&   
'   :"^"88888h.    '!   9888  9888   "*88*" 8888"  "8888Y 8888"  ?8888u../  888E  888E 9888  9888   "*88*" 8888" .888N..888  9888  9888   ^"8888*"      888E  9888.  
'   ^    "88888hx.+"    "888*""888"    ""   'Y"     `Y"   'YP     "8888P'  m888N= 888> "888*""888"    ""   'Y"    `"888*""   "888*""888"     "Y"      '"888*" 4888"  
'          ^"**""        ^Y"   ^Y'                                  "P'     `Y"   888   ^Y"   ^Y'                    ""       ^Y"   ^Y'                  ""    ""    
'                                                                                J88"                                                                                
'                                                                                @%                                                                                  
'                                                                              :"                                                                                    
'  88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 
'  88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 88888888 

Version 1.0.0 || Date: 13/02/2025
Version log: Text Compare,  Case convertor, Lorepsum generator, Double space cheker 
Version 2.0.0 || Date: 15/02/2025
Version log: Text Compare,  Case convertor, Lorepsum generator, Double space cheker 
Update Log: Enhanced Text compare, Added new case convertor, Added new lorem ipsum generator, Added new double space checker, Added new theme switcher.
Version 3.0.0 || Date: 16/02/2025
Version log: Text Compare,  Case convertor, Lorepsum generator, Double space cheker 
Update Log: AddedImage compressor, Added File Analyser, Added a ***, Added new theme switcher, Ignored macosx and DS folder from the results.
Version 3.0.1 || Date: 24/02/2025
Version log: Text Compare,  Case convertor, Lorepsum generator, Double space cheker , File analyser
Update Log: Removed Image compressor, Updated Text compare UI, Removed capitalised case for Case convertor.
Version 4.0.0 || Date: 25/02/2025
Version log: Text Compare,  Case convertor, Lorepsum generator, Double space cheker , File analyser, Image compare
Update Log: Added Image compare with Advanced layer settings.
Version 4.0.1 || Date: 27/05/2025
Version log: Text Compare,  Case convertor, Lorepsum generator, Double space cheker , File analyser, Image compare
Update Log: File analyser with Filter and sort settings.
Version 5.0.0 || Date: 27/05/2025
Version log: Text Compare,  Case convertor, Lorepsum generator, Double space cheker , File analyser, Image compare, Notes
Update Log: Notes with deatils for the technical specifications for Static and video files.

-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalyst - Multi-Tool Suite</title>
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-color: #ffffff;
            --text-color: #2d3436;
            --primary-color: #056dce;
            --border-color: #056dce;
            --diff-added: #00ff3c;
            --diff-removed: #ff001e;
            --tool-bg: #ffffff;
            --tab-button: #2d3436;
        }

        [data-theme="dark"] {
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --primary-color: #056dce;
            --border-color: #056dce;
            --diff-added: #00ff59;
            --diff-removed: #ff0000;
            --tool-bg: #2d2d2d;
            --tab-button: #e0e0e0;
        }
        [data-theme="dark"] .tab button {
    color: white;
}

        body {
            font-family: 'Barlow', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: var(--bg-color);
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .header {
    display: flex;
    justify-content: center; /* Center the content horizontally */
    align-items: center;
    margin-bottom: 2rem;
    padding: 0 20px;
    position: relative;
    gap: 15px; /* Add space between logo and text */
}

.header .logo-container {
    display: flex;
    align-items: center;
}

.header .logo {
    width: 60px;
    margin-right: 0px;
}

.header h1 {
    font-size: 2.5rem;
    margin: 0;
    color: var(--text-color);
}

@media (max-width: 768px) {
    .header {
        flex-direction: column;
        text-align: center;
    }

    .theme-toggle {
        position: absolute;
        top: 10px;
        right: 10px;
    }
}
        .theme-toggle {
            position: absolute;
            top: 10px;
            right: 20px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 5px;
            background: var(--primary-color);
            color: white;
            border: none;
        }

        .tab {
    overflow: hidden;
    border: 1px solid var(--border-color);
    background-color: var(--tool-bg);
    border-radius: 8px;
    margin-bottom: 20px;
    padding: 10px; /* Add padding for spacing */
    display: flex;
    gap: 10px; /* Add 10px spacing between buttons */
}

.tab button {
    background-color: var(--tool-bg);
    float: left;
    border: 1px solid var(--primary-color);
    outline: none;
    cursor: pointer;
    padding: 14px 20px;
    transition: 0.3s;
    font-family: 'Barlow', sans-serif;
    font-weight: 600;
    color: #5a5a5a; /* Default grey color for better readability */
    border-radius: 6px;
}

.tab button:hover {
    background-color: var(--primary-color);
    color: white; /* White text on hover for both themes */
    transform: translateY(-1px);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.tab button.active {
    background-color: var(--primary-color);
    color: white; /* White text for active state in both themes */
    border-color: var(--primary-color);
}

        .tabcontent {
            display: none;
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--tool-bg);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        
        textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            resize: vertical;
            font-family: monospace;
            background: var(--tool-bg);
            color: var(--text-color);
        }

        button {
            padding: 12px 25px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.3s;
            font-family: 'Barlow', sans-serif;
        }

        button:hover {
            filter: brightness(0.9);
        }

        .diff-result {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            font-family: monospace;
            white-space: pre-wrap;
            padding: 15px;
            background: var(--tool-bg);
            border-radius: 8px;
        }

        .diff-removed {
            background: var(--diff-removed);
            text-decoration: line-through;
        }

        .diff-added {
            background: var(--diff-added);
        }

        .compare-options {
            margin: 10px 0;
            display: flex;
            gap: 15px;
        }

        .diff-column {
            white-space: pre-wrap;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
        }

        .highlight {
            background-color: #ffeb3b;
            padding: 2px 4px;
            border-radius: 3px;
        }

        [data-theme="dark"] .highlight {
            background-color: #ff5722;
        }
        .compare-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .text-input {
            background: var(--tool-bg);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .result {
            font-family: monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            padding: 15px;
            border-radius: 4px;
            background: var(--tool-bg);
            border: 1px solid var(--border-color);
        }

        

        .linebreak {
            color: var(--primary-color);
            font-weight: bold;
        }
        .container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        max-width: 1200px;
        margin: 0 auto;
    }

    .text-input {
        background: #333;
        color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    textarea {
        width: 100%;
        height: 200px;
        padding: 10px;
        border: 1px solid #555;
        border-radius: 4px;
        resize: vertical;
        font-family: monospace;
        background-color: #444;
        color: white;
    }

    .compare-button {
        grid-column: span 2;
        padding: 12px 24px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        transition: background 0.3s;
    }

    .compare-button:hover {
        background: #0056b3;
    }

    .result {
        background: #333;
        color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        font-family: monospace;
        white-space: pre-wrap;
        word-wrap: break-word;
    }

    .deleted {
        background: #ff0000;
    text-decoration: line-through;
    opacity: 0.7;
    }

    .added {
        background: #00ff00;
    color: black;
    opacity: 0.7;
    }

    h2 {
        margin-top: 0;
        color: #eee;
        font-size: 1.2em;
    }
    .tool-section {
    padding: 20px;
    background: var(--tool-bg);
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
.tool-section button {
    min-width: 150px;
    margin: 0 auto;
    padding: 12px 30px;
    font-size: 1.1em;
}

.tool-section button:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.compare-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
}

.text-input {
    background: var(--tool-bg);
    padding: 15px;
    border-radius: 4px;
    border: 1px solid var(--border-color);
}

.text-input h3 {
    margin-top: 0;
    margin-bottom: 15px;
    color: var(--text-color);
    font-size: 1.2em;
    font-family: 'Barlow', sans-serif;
}

textarea {
    width: 100%;
    height: 200px;
    padding: 15px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    resize: vertical;
    font-family: monospace;
    background: var(--tool-bg);
    color: var(--text-color);
}

.result {
    color: var(--text-color);
    font-family: monospace;
    white-space: pre-wrap;
    word-wrap: break-word;
    padding: 15px;
    border-radius: 4px;
    background: var(--tool-bg);
    border: 1px solid var(--border-color);
    min-height: 100px;
}

button {
    padding: 12px 25px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: 0.3s;
    font-family: 'Barlow', sans-serif;
    margin: 10px 0;
}

button:hover {
    filter: brightness(0.9);
}

.deleted {
    background: var(--diff-removed);
    text-decoration: line-through;
}

.added {
    background: var(--diff-added);
}

.linebreak {
    color: var(--primary-color);
    font-weight: bold;
}


#textCompare .match-indicator {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #4CAF50;
    font-weight: 500;
}

#textCompare .checkmark {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    stroke-width: 2;
    stroke: #4CAF50;
    stroke-miterlimit: 10;
    animation: fill .4s ease-in-out .4s forwards, scale .3s ease-in-out .9s both;
}

#textCompare .checkmark__circle {
    stroke-dasharray: 166;
    stroke-dashoffset: 166;
    stroke-width: 2;
    stroke-miterlimit: 10;
    stroke: #4CAF50;
    fill: none;
    animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
}

#textCompare .checkmark__check {
    transform-origin: 50% 50%;
    stroke-dasharray: 48;
    stroke-dashoffset: 48;
    stroke: #4CAF50;
    animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;
}


#textCompare button {
    min-width: 120px;
    padding: 12px 25px;
    border: none;
    border-radius: 6px;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    font-family: 'Barlow', sans-serif;
}

#textCompare button:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    filter: brightness(0.9);
}
@keyframes stroke {
    100% { stroke-dashoffset: 0; }
}

@keyframes scale {
    0%, 100% { transform: none; }
    50% { transform: scale3d(1.1, 1.1, 1); }
}

@keyframes fill {
    100% { box-shadow: inset 0px 0px 0px 30px transparent; }
}




#caseOutput {
    padding: 15px;
    background: var(--tool-bg);
    border-radius: 6px;
    margin-top: 20px;
    white-space: pre-wrap;       /* preserve line breaks but wrap text */
    word-wrap: break-word;       /* break long words */
    overflow-wrap: break-word;   /* newer syntax for breaking long words */
    word-break: break-all;       /* ensure long strings without spaces wrap */
    max-width: 100%;            /* ensure content stays within container */
    font-family: monospace;     /* keep monospace font for code-like content */
}
.case-buttons-container {
    display: flex;
    gap: 20px;
    margin: 15px 0;
}

.case-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 10px;
    flex: 3;
}

.action-buttons {
    display: flex;
    flex-direction: column;
    gap: 10px;
    flex: 1;
}
.text-input h3 {
    margin-top: 0;
    margin-bottom: 15px;
    color: var(--text-color);
    font-size: 1.2em;
    font-family: 'Barlow', sans-serif;
}

#caseConverter .tool-section {
    display: flex;
    gap: 20px;
    align-items: flex-start;
}

#caseConverter .input-output-section {
    flex: 4; /* Increase from 2 to 3 to reduce button section width */
}

#caseConverter .button-section {
    flex: 1; /* Take 1/4 of the space */
    position: sticky;
    top: 20px;
    align-self: flex-start;
    max-width: 400px; /* Limit maximum width */
}

#caseConverter .case-buttons {
    display: grid;
    grid-template-columns: 1fr; /* Single column by default */
    gap: 8px;
    margin-bottom: 15px;
}

#caseConverter .case-buttons button {
    padding: 8px 12px;
    font-size: 0.9em;
    white-space: nowrap;
    width: 100%;
}

/* Responsive design */
@media (min-width: 1200px) {
    #caseConverter .case-buttons {
        grid-template-columns: repeat(2, 1fr); /* 2 columns on larger screens */
    }
}

@media (max-width: 768px) {
    #caseConverter .tool-section {
        flex-direction: column;
    }

    #caseConverter .button-section {
        position: static;
        max-width: 100%;
        width: 100%;
    }

    #caseConverter .case-buttons {
        grid-template-columns: repeat(2, 1fr); /* 2 columns on mobile */
    }
}

@media (max-width: 480px) {
    #caseConverter .case-buttons {
        grid-template-columns: 1fr; /* Single column on very small screens */
    }
}

#caseConverter .case-buttons button {
    padding: 8px 12px;
    font-size: 0.9em;
    white-space: nowrap;
    width: 100%;
}

#caseConverter .action-buttons {
    display: grid;
    grid-template-columns: 1fr; /* Single column */
    gap: 8px;
    margin-top: 15px;
}

#caseConverter .action-buttons button {
    width: 100%;
}

#caseConverter .form-check {
    margin: 15px 0;
}

#caseConverter textarea {
    width: 100%;
    resize: vertical;
    min-height: 200px;
    max-height: 600px;
}
<!--Double space checker-->
.result-box {
    background: var(--tool-bg);
    padding: 15px;
    border-radius: 8px;
    border: 1px solid var(--border-color);
}

.text-content {
    margin-top: 10px;
    line-height: 1.5;
    background: var(--bg-color);
    border: 1px solid var(--border-color);
    padding: 15px;
    border-radius: 4px;
    min-height: 100px;
}

.space-actions {
    display: flex;
    gap: 10px;
}

.space-btn {
    padding: 8px 16px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.space-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    filter: brightness(0.9);
}

.btn-danger {
    background: #f44336 !important; /* Same red as text compare clear button */
    color: white;
    padding: 12px 25px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-family: 'Barlow', sans-serif;
}

.btn-danger:hover {
    filter: brightness(0.9);
    transform: translateY(-1px);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}
<!-- Image compressor Styles-->
.upload-area {
        border: 2px dashed var(--border-color);
        padding: 2rem;
        text-align: center;
        margin-bottom: 1rem;
        border-radius: 8px;
        background: var(--tool-bg);
        transition: all 0.3s ease;
    }

    .upload-area.dragover {
        border-color: var(--primary-color);
        background-color: var(--bg-color);
    }

    .btn-upload {
        background: var(--primary-color);
        color: white;
        padding: 12px 25px;
        border-radius: 6px;
        cursor: pointer;
        display: inline-block;
        margin: 1rem 0;
    }

    .btn-upload:hover {
        filter: brightness(0.9);
    }

    .btn-download {
        background: #4CAF50;
        margin-top: 1rem;
    }

    .file-list {
        color: var(--text-color);
        margin: 1rem 0;
        font-size: 0.9em;
    }

    .loading {
        color: var(--text-color);
        margin: 1rem 0;
    }

    #fileInput {
        display: none;
    }

    .compression-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    background: var(--tool-bg);
    border-radius: 6px;
    overflow: hidden;
}

.compression-table th, 
.compression-table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
}

.compression-table th {
    background: var(--primary-color);
    color: white;
    font-weight: 600;
}

.compression-table tr:hover {
    background: rgba(0,0,0,0.1);
}

<!-- File analyser Styles-->
#fileAnalyser {
    margin-top: 20px;
}

#fileAnalyser h3 {
    font-size: 1.5rem;
    margin-bottom: 15px;
    color: var(--text-color);
    font-family: 'Barlow', sans-serif;
}

#fileAnalyser input[type="file"] {
    margin: 10px 0;
    background: var(--tool-bg);
    color: var(--text-color);
    border: 1px solid var(--border-color);
    padding: 8px;
    border-radius: 4px;
}

#fileAnalyser #fileTable {
    display: none; /* Initially hidden, will change once a ZIP is loaded */
    margin-top: 15px;
}

#fileAnalyser .compression-table {
    width: 100%;
    table-layout: fixed; /* Add fixed table layout */
    border-collapse: collapse;
    background: var(--tool-bg);
    border-radius: 6px;
    overflow: hidden;
}

#fileAnalyser .compression-table th,
#fileAnalyser .compression-table td {
    padding: 12px;
    border: 1px solid var(--border-color);
    text-align: left;
    color: var(--text-color);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Define column widths */
#fileAnalyser .compression-table th:nth-child(1),
#fileAnalyser .compression-table td:nth-child(1) {
    width: 40%; /* Name column */
}

#fileAnalyser .compression-table th:nth-child(2),
#fileAnalyser .compression-table td:nth-child(2) {
    width: 10%; /* Format column */
}

#fileAnalyser .compression-table th:nth-child(3),
#fileAnalyser .compression-table td:nth-child(3) {
    width: 20%; /* Size column */
}

#fileAnalyser .compression-table th:nth-child(4),
#fileAnalyser .compression-table td:nth-child(4) {
    width: 15%; /* Dimensions column */
}

#fileAnalyser .compression-table th:nth-child(5),
#fileAnalyser .compression-table td:nth-child(5) {
    width: 10%; /* Duration column */
}

#fileAnalyser .compression-table th:nth-child(6),
#fileAnalyser .compression-table td:nth-child(6) {
    width: 5%; /* Color Mode column */
}

#fileAnalyser .folder {
    cursor: pointer;
    background-color: var(--tool-bg);
    color: var(--text-color);
}

#fileAnalyser .toggle {
    display: inline-block;
    width: 20px;
    transition: transform 0.2s;
    cursor: pointer;
}

#fileAnalyser .folder.expanded .toggle {
    transform: rotate(90deg);
}

#fileAnalyser tr[data-parent] {
    background-color: var(--tool-bg);
}

#fileAnalyser .hidden {
    display: none;
}
#fileAnalyser .upload-controls {
    margin: 1rem 0;
}

#fileAnalyser .upload-row {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
}

#fileAnalyser .btn-upload {
    min-width: 120px;
    text-align: center;
    margin: 0;
    background: var(--primary-color);
    color: white;
    padding: 12px 25px;
    border-radius: 6px;
    cursor: pointer;
    display: inline-block;
    font-family: 'Barlow', sans-serif;
}

#fileAnalyser .btn-upload:hover {
    filter: brightness(0.9);
}

#fileAnalyser .progress-status {
    padding: 8px 16px;
    background: var(--tool-bg);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    min-width: 200px;
}

#fileAnalyser .progress-container {
    display: flex;
    align-items: center;
    gap: 10px;
    flex: 1;
}

#fileAnalyser .filename-bar {
    background: var(--tool-bg);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 8px 12px;
}

#fileAnalyser .progress-bar-container {
    background: var(--tool-bg);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 8px 12px;
    position: relative;
}

#fileAnalyser .progress-bar {
    height: 4px;
    background: var(--primary-color);
    border-radius: 2px;
    width: 0;
    transition: width 0.3s ease;
}

#fileAnalyser .status-text {
    margin-top: 4px;
    font-size: 0.9em;
    color: var (--text-color);
}

#fileAnalyser .loading-spinner {
    display: none;
    width: 16px;
    height: 16px;
    border: 2px solid var (--primary-color);
    border-top: 2px solid transparent;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
}

@keyframes spin {
    0% { transform: translateY(-50%) rotate(0deg); }
    100% { transform: translateY(-50%) rotate(360deg); }
}
#fileAnalyser .control-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 20px;
    margin-bottom: 10px;
}

#fileAnalyser .upload-row {
    display: flex;
    align-items: center;
    gap: 10px;
    flex: 2;
}

#fileAnalyser .progress-container {
    flex: 1;
}


#fileAnalyser .size-filter input[type="number"] {
    width: 80px;
    padding: 4px 8px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background: var(--tool-bg);
    color: var(--text-color);
}

#fileAnalyser .size-filter input[type="radio"]:disabled + label {
    opacity: 0.5;
}
#fileAnalyser .upload-controls {
    margin: 1rem 0;
}

#fileAnalyser .control-row {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 10px;
}

#fileAnalyser .upload-row {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%; /* Take full width */
}

#fileAnalyser .btn-upload {
    min-width: 120px; /* Fixed width for button */
    white-space: nowrap;
}

#fileAnalyser .progress-container {
    display: flex;
    align-items: center;
    gap: 10px;
    flex: 1; /* Take remaining space */
}

#fileAnalyser .filename-bar {
    flex: 1; /* Take half of the remaining space */
    background: var(--tool-bg);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 8px 12px;
}

#fileAnalyser .progress-bar-container {
    flex: 1; /* Take other half of the remaining space */
    background: var(--tool-bg);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 8px 12px;
    position: relative;
}
#fileAnalyser .upload-area {
    border: 2px dashed var(--border-color);
    padding: 2rem;
    text-align: center;
    margin-bottom: 1rem;
    border-radius: 8px;
    background: var(--tool-bg);
    transition: all 0.3s ease;
}

#fileAnalyser .upload-area.dragover {
    border-color: var(--primary-color);
    background-color: var(--bg-color);
}
#fileAnalyser .btn-reset {
    background: #f44336;
    color: white;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    border: none;
    font-family: 'Barlow', sans-serif;
    transition: all 0.3s ease;
    white-space: nowrap;
    opacity: 0.5; /* Add default opacity */
    pointer-events: none; /* Disable interactions by default */
}
#fileAnalyser .btn-reset.active {
    opacity: 1;
    pointer-events: auto;
}

#fileAnalyser .btn-reset:hover {
    filter: brightness(0.9);
    transform: translateY(-1px);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}


<!--EE Styles-->
.easter-egg-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--tool-bg);
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.3);
    z-index: 1000;
    animation: popIn 0.3s ease-out;
    border: 2px solid var(--primary-color);
    position: relative;
    overflow: hidden;
}
#fileTable .filter-row th {
    padding: 5px;
    background: var(--tool-bg);
}

#fileTable .column-filter {
    width: 100%;
    padding: 4px 8px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background: var(--bg-color);
    color: var(--text-color);
}

#fileTable .size-filter {
    display: flex;
    gap: 5px;
    align-items: center;
}

#fileTable .filter-operator,
#fileTable .size-unit {
    padding: 4px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background: var(--bg-color);
    color: var(--text-color);
}

#fileTable .size-value {
    width: 80px;
    padding: 4px 8px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background: var(--bg-color);
    color: var(--text-color);
}

#fileTable .sort-icon {
    margin-left: 5px;
    opacity: 0.5;
}

#fileTable th.sorted-asc .sort-icon::after {
    content: '↑';
}

#fileTable th.sorted-desc .sort-icon::after {
    content: '↓';
}

:root {
    --highlight-color-rgb: 255, 0, 0; /* Changed from blue to red */
}

[data-theme="dark"] {
    --highlight-color-rgb: 255, 0, 0; /* Changed from blue to red */
}

#fileTable tr.size-highlight {
    transition: background-color 0.3s ease;
}

#fileTable tr.size-highlight:hover {
    background-color: rgba(var(--highlight-color-rgb), 0.2) !important;
}

/* Add a pseudo-element for the background pattern */
.easter-egg-popup::before {
    content: '';
    position: absolute;
    inset: 2px; /* Match the border width */
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 512 512'%3E%3Cpath transform='rotate(20 256 256)' fill='rgba(0,0,0,0.08)' d='M269.5,-0.5 C269.833,-0.5 270.167,-0.5 270.5,-0.5C 270.5,39.8333 270.5,80.1667 270.5,120.5C 299.169,120.333 327.835,120.5 356.5,121C 318.127,190.247 279.627,259.414 241,328.5C 240.5,289.168 240.333,249.835 240.5,210.5C 211.831,210.667 183.165,210.5 154.5,210C 193.227,140.046 231.56,69.8798 269.5,-0.5 Z'/%3E%3C/svg%3E");
    background-size: 8px 8px;
    background-repeat: repeat;
    
    opacity: 0.25;
    pointer-events: none;
    z-index: 0;
    background-color: rgba(128, 128, 128, 0.03);
    border-radius: 10px; /* Slightly smaller than parent's border-radius */
    -webkit-mask-image: radial-gradient(
        circle at center,
        black 0%,
        black 95%,
        transparent 100%
    );
    mask-image: radial-gradient(
        circle at center,
        black 0%,
        black 95%,
        transparent 100%
    );
}

[data-theme="dark"] .easter-egg-popup::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 512 512'%3E%3Cpath transform='rotate(20 256 256)' fill='rgba(255,255,255,0.08)' d='M269.5,-0.5 C269.833,-0.5 270.167,-0.5 270.5,-0.5C 270.5,39.8333 270.5,80.1667 270.5,120.5C 299.169,120.333 327.835,120.5 356.5,121C 318.127,190.247 279.627,259.414 241,328.5C 240.5,289.168 240.333,249.835 240.5,210.5C 211.831,210.667 183.165,210.5 154.5,210C 193.227,140.046 231.56,69.8798 269.5,-0.5 Z'/%3E%3C/svg%3E");
}
/* Ensure content stays above the pattern */
.easter-egg-popup .footer-content {
    position: relative;
    z-index: 1;
}
.easter-egg-popup .close-button {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    color: var(--text-color);
    cursor: pointer;
    padding: 5px;
    font-size: 20px;
    z-index: 2;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.3s ease;
}

.easter-egg-popup .close-button:hover {
    background: rgba(0, 0, 0, 0.1);
    transform: scale(1.1);
}

[data-theme="dark"] .easter-egg-popup .close-button:hover {
    background: rgba(255, 255, 255, 0.1);
}


/* Add clean animation */
@keyframes patternFloat {
    0% {
        transform: rotate(15deg) translate(0, 0);
    }
    50% {
        transform: rotate(15deg) translate(-10px, -10px);
    }
    100% {
        transform: rotate(15deg) translate(0, 0);
    }
}
.color-picker-popup .color-picker-container {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin: 20px 0;
}

.color-picker-popup input[type="color"] {
    width: 100px;
    height: 100px;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    padding: 0;
    margin: 0 auto;
}

.color-picker-popup .random-color-btn,
.color-picker-popup .apply-color-btn {
    background: var(--primary-color);
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.color-picker-popup .random-color-btn:hover,
.color-picker-popup .apply-color-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.color-picker-popup .apply-color-btn {
    margin-top: 15px;
    width: 100%;
}
.error-message {
    background: var(--tool-bg);
    color: #f44336;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    margin: 20px 0;
    border: 1px solid #f44336;
}
.train-marquee {
    display: none;
    position: fixed;
    bottom: 4px;
    width: 100%;
    background: var(--bg-color);
    color: var(--text-color);
    font-size: 15px;
    white-space: nowrap;
    overflow: hidden;
    z-index: 1000;
    padding: 4px 0;
    box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
    border-top: 1px solid var(--primary-color);
}

.train-marquee span {
    display: inline-block;
    padding: 0px;
    animation: marquee 10s linear infinite;
    font-family: 'Barlow', sans-serif;
}

@keyframes marquee {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
}

#imageDiff .upload-section {
    margin-bottom: 20px;
    background: var(--tool-bg);
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

#imageDiff .controls {
    margin: 20px 0;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

#imageDiff .main-content {
    display: grid;
    grid-template-columns: 70% 30%;
    gap: 20px;
}

#imageDiff .image-compare {
    position: relative;
    margin-top: 45px; /* Add margin to accommodate zoom controls */
    margin-bottom: 20px;
    background: var(--tool-bg);
    border-radius: 8px;
    padding: 15px;
}

#imageDiff .image-viewer {
    position: relative;
    overflow: auto;
    height: 600px;
    border-radius: 8px;
    background: var(--tool-bg);
}

#imageDiff .image-container {
    position: relative;
    width: 100%;
    height: 100%;
    transform-origin: 0 0;
    min-height: 400px;
    border: 2px dashed var(--border-color);
    border-radius: 8px;
    background: var(--tool-bg);
}
#imageDiff .image-container::before {
    content: 'Canvas Background';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--text-color);
    opacity: 0.5;
    font-size: 1.2em;
    pointer-events: none;
}

#imageDiff .image:not([src]) {
    display: none;
}

#imageDiff .image[src] + #imageDiff .image-container::before {
    display: none;
}

#imageDiff .image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: contain;
}

#imageDiff .advanced-settings {
    background: var(--tool-bg);
    border-radius: 8px;
    margin-bottom: 15px;
    border: 1px solid var(--border-color);
}

#imageDiff .advanced-settings summary {
    padding: 12px 15px;
    cursor: pointer;
    background: var(--tool-bg);
    color: var(--text-color);
    border-radius: 8px;
    user-select: none;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
}
/* Add arrow indicator */
#imageDiff .advanced-settings summary::before {
    content: '▶';
    display: inline-block;
    transition: transform 0.3s;
    font-size: 12px;
    width: 12px;
    text-align: center;
}

/* Rotate arrow when open */
#imageDiff .advanced-settings[open] summary::before {
    transform: rotate(90deg);
}
#imageDiff .advanced-settings summary:hover {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

#imageDiff .advanced-settings[open] summary {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    border-bottom: 1px solid var(--border-color);
}

#imageDiff .layer-controls {
    padding: 15px;
    background: var(--tool-bg);
    margin: 0;
}

#imageDiff .layer-item {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 10px;
    padding: 15px;
    background: var(--bg-color);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    transition: all 0.3s ease;
}

#imageDiff .layer-item:hover {
    border-color: var(--primary-color);
    background: rgba(var(--primary-color-rgb), 0.05);
}

#imageDiff .layer-item:last-child {
    margin-bottom: 0;
}

#imageDiff .zoom-controls {
    position: absolute;
    top: -40px; /* Position above the image viewer */
    right: 0;
    z-index: 1000;
    background: var(--tool-bg);
    padding: 4px;
    border-radius: 4px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    display: flex;
    gap: 2px;
    border: 1px solid var(--border-color);
}

#imageDiff .zoom-controls button {
    width: 24px; /* Reduced from 28px */
    height: 24px; /* Reduced from 28px */
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px; /* Reduced from 16px */
    background: transparent;
    color: var(--text-color);
    min-width: unset; /* Override any minimum width */
}

#imageDiff .zoom-controls button:hover {
    background: var(--primary-color);
    color: white;
}

#imageDiff .zoom-controls #resetZoom {
    width: auto;
    padding: 0 6px; /* Reduced from 8px */
    font-size: 11px; /* Reduced from 12px */
}

#imageDiff .file-details {
    position: sticky;
    top: 20px;
}

#imageDiff .file-info {
    background: var(--tool-bg);
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 15px;
    border: 1px solid var(--border-color);
}

#imageDiff button {
    padding: 8px 16px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.3s ease;
}

#imageDiff button:hover {
    filter: brightness(0.9);
    transform: translateY(-1px);
}

#imageDiff .hidden {
    display: none;
}
/*Image diff checker*/
#imageDiff .error {
    color: #f44336;
    padding: 10px;
    margin: 10px 0;
    border-radius: 4px;
    background: var(--tool-bg);
    border: 1px solid #f44336;
}
#imageDiff .upload-section {
    margin-bottom: 20px;
}

#imageDiff .upload-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

#imageDiff .upload-box {
    position: relative;
    min-height: 200px;
    border: 2px dashed var(--border-color);
    border-radius: 8px;
    background: var(--tool-bg);
    transition: all 0.3s ease;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
}

#imageDiff .upload-box:hover {
    border-color: var(--primary-color);
    background: rgba(var(--primary-color-rgb), 0.05);
}

#imageDiff .upload-box.dragover {
    border-color: var(--primary-color);
    background: rgba(var(--primary-color-rgb), 0.1);
    transform: scale(1.02);
}

#imageDiff .file-input {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    opacity: 0;
    cursor: pointer;
}

#imageDiff .upload-content {
    text-align: center;
    pointer-events: none;
}

#imageDiff .upload-icon {
    width: 48px;
    height: 48px;
    fill: var(--primary-color);
    margin-bottom: 15px;
}

#imageDiff .upload-text h3 {
    margin: 0 0 8px;
    color: var(--text-color);
    font-size: 1.2em;
}

#imageDiff .upload-text p {
    margin: 0;
    color: var(--text-color);
    opacity: 0.8;
    font-size: 0.9em;
}

#imageDiff .upload-preview {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: contain;
    padding: 10px;
    background: var(--tool-bg);
}
#imageDiff .upload-details {
    background: var(--tool-bg);
    border-radius: 8px;
    margin-bottom: 15px;
    border: 1px solid var(--border-color);
}

#imageDiff .upload-details summary {
    padding: 12px 15px;
    cursor: pointer;
    background: var(--tool-bg);
    color: var(--text-color);
    border-radius: 8px;
    user-select: none;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
}

#imageDiff .upload-details summary::before {
    content: '▶';
    display: inline-block;
    transition: transform 0.3s;
    font-size: 12px; /* Make arrow size consistent */
    width: 12px; /* Fixed width to prevent layout shift */
}

#imageDiff .upload-details[open] summary::before {
    transform: rotate(90deg);
}

#imageDiff .upload-details summary:hover {
    background: var(--primary-color);
    color: white;
}

#imageDiff .upload-details[open] summary {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    border-bottom: 1px solid var(--border-color);
}

#imageDiff .upload-section {
    padding: 15px;
    margin: 0;
}

#imageDiff .upload-box {
    min-height: 150px;
    max-height: 150px;
}
#imageDiff #newCheck {
    background-color: #f44336;
    color: white;
}

#imageDiff #newCheck:hover {
    background-color: #d32f2f;
}
#imageDiff .layer-header span:not(.eye-icon) {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 400px; /* Adjust this value based on your layout */
    display: inline-block;
    cursor: default;
    
}
#imageDiff .layer-header span:not(.eye-icon):hover::after {
    content: attr(title); /* Uses the title attribute as tooltip content */
    position: absolute;
    left: 0;
    top: -30px;
    background: var(--tool-bg);
    color: var(--text-color);
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.9em;
    white-space: nowrap;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    border: 1px solid var(--border-color);
    z-index: 1000;
}

#imageDiff .layer-header .eye-icon {
    cursor: pointer;
    user-select: none;
    transition: transform 0.2s ease;
}

#imageDiff .layer-header .eye-icon:hover {
    transform: scale(1.1);
}

#imageDiff .layer-header {
    display: flex;
    align-items: center;
    gap: 8px;
    min-width: 0; /* Add this to allow text truncation */
    flex: 1; /* Allow header to take available space */
    cursor: default;
}

#imageDiff .blend-mode-select {
    width: 120px; /* Set fixed width for the select element */
    min-width: 120px; /* Ensure minimum width */
    flex-shrink: 0; /* Prevent select from shrinking */
}
#imageDiff .blend-modes {
    display: flex;
    gap: 10px; /* Add gap between buttons */
    flex-wrap: wrap;
}

#imageDiff .blend-modes button {
    padding: 8px 16px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap; /* Prevent button text from wrapping */
}

#imageDiff .blend-modes button:hover {
    filter: brightness(0.9);
    transform: translateY(-1px);
}



/* PRODUCT NOTES STYLES */
        #productNotes .app-container {
    max-width: 2000px;
    margin: 0 auto;
    background-color: var(--tool-bg);
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    overflow: hidden;
    position: relative;
    border: 1px solid var(--border-color);
}
        
        #productNotes .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #7209b7 100%);
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        
        #productNotes .header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 90% 10%, rgba(255,255,255,0.1) 0%, transparent 70%);
            pointer-events: none;
        }
        
        #productNotes .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            z-index: 2;
        }
        
        #productNotes .logo i {
            font-size: 32px;
            color: #ffd700;
        }
        
        #productNotes .logo h1 {
            font-weight: 800;
            font-size: 28px;
            letter-spacing: -0.5px;
            background: linear-gradient(to right, #fff, #d4e0ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        #productNotes .controls {
            display: flex;
            gap: 12px;
            position: relative;
            z-index: 2;
        }
        
        #productNotes .btn {
            padding: 12px 22px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-color);
            transition: all 0.3s ease;
            font-size: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        #productNotes .btn-primary {
    background: transparent;
    color: var(--text-color);
    border: 2px solid var(--primary-color);
    padding: 12px 22px;
    border-radius: 8px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
    font-size: 15px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
        
[data-theme="light"] #productNotes .btn-primary {
    background: transparent;
    color: var(--text-color);
}

[data-theme="dark"] #productNotes .btn-primary {
    background: transparent;
    color: var(--text-color);
}

        #productNotes .btn-primary:hover {
    background: var(--primary-color);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
}
        
        #productNotes .btn-outline {
            background-color: transparent;
            border: 2px solid var(--border-color);
            color: var(--text-color);
            backdrop-filter: blur(5px);
        }
        
        #productNotes .btn-outline:hover {
            background-color: rgba(255, 255, 255, 0.15);
            border-color: var(--border-color);
            transform: translateY(-2px);
        }
        
        #productNotes .btn-edit {
            transition: all 0.3s ease;
            background: linear-gradient(to right, #ff9800, #e68a00);
            color: var(--text-color);
        }
        
        #productNotes .btn-edit:hover {
            background: linear-gradient(to right, #e68a00, #d67d00);
            transform: translateY(-2px);
            opacity: 0.8;
        }
        
        #productNotes .main-content {
            padding: 25px;
            background-color: var(--tool-bg);
            display: flex;
            flex-direction: column;
        }
        
        #productNotes .table-container {
    margin-top: 20px;
    overflow-x: auto;
    border-radius: 12px;
    border: 1px solid var(--border-color);
    background: var(--tool-bg);
    box-shadow: 0 6px 16px rgba(0,0,0,0.1);
}
        
        #productNotes .product-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            min-width: 1000px;
        }
        
        #productNotes .product-table th {
    background: var(--primary-color);
    padding: 18px 15px;
    text-align: left;
    font-weight: 600;
    color: #ffffff;
    border-bottom: 1px solid var(--border-color);
    cursor: pointer;
    user-select: none;
    position: sticky;
    top: 0;
    z-index: 10;
}
        
        #productNotes .product-table th:hover {
            background: null;
        }
        
        #productNotes .product-table th i {
            margin-left: 8px;
            font-size: 14px;
            opacity: 0.7;
        }
        
       #productNotes .product-table td {
    padding: 16px 15px;
    border-bottom: 1px solid var(--border-color);
    color: var(--text-color);
    position: relative;
}
        
        #productNotes .product-table tr {
    background-color: var(--tool-bg);
    transition: background-color 0.2s;
}
#productNotes .stats-toggle {
    background: none;
    border: none;
    color: var(--text-color);
    cursor: pointer;
    width: 100%;
    text-align: left;
    padding: 15px;
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid var(--border-color);
    margin-top: 20px;
}

#productNotes .stats-toggle::after {
    content: '▼';
    font-size: 12px;
    transition: transform 0.3s ease;
}

#productNotes .stats-toggle.collapsed::after {
    transform: rotate(-90deg);
}

#productNotes .stats-container {
    display: none;  /* Hidden by default */
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    padding: 20px;
    background: var(--tool-bg);
    border-bottom: 1px solid var(--border-color);
}

#productNotes .stats-container.visible {
    display: grid;
}
       #productNotes .product-table tr:nth-child(even) {
    background-color: rgba(var(--primary-color-rgb), 0.05);
}
        
        #productNotes .product-table tr:hover {
    background-color: rgba(var(--primary-color-rgb), 0.1);
}
        
        #productNotes .folder-row {
            background: var(--tool-bg) !important;
            font-weight: 700;
        }
    
        
        #productNotes.folder-toggle {
            display: inline-block;
            width: 26px;
            height: 26px;
            border-radius: 6px;
            background: rgba(255,255,255,0.15);
            text-align: center;
            line-height: 26px;
            margin-right: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        #productNotes .folder-row.expanded .folder-toggle {
            transform: rotate(90deg);
            
        }
        
        #productNotes .folder-icon {
            font-size: 18px;
            margin-right: 12px;
        }
        
        #productNotes .folder-icon-top {
            color: #ffd700 !important;
        }
        
        #productNotes .folder-icon-sub {
            color: var(--primary-color) !important;
        }
        
        #productNotes .folder-icon-deep {
            color: #f44336 !important;
        }
        
        #productNotes .product-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }
        
        #productNotes .action-btn {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background: rgba(var(--primary-color-rgb), 0.1);
            color: var(--text-color);
            transition: all 0.3s ease;
            font-size: 16px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        #productNotes .action-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(67, 97, 238, 0.3);
        }
        
        #productNotes .action-btn.delete-btn:hover, 
        #productNotes .action-btn.delete-folder-btn:hover {
            background: #d32f2f !important;
            color: white;
        }
        
        #productNotes .highlight {
            background-color: #ffd700;
            color: #000;
            font-weight: bold;
            padding: 0 4px;
            border-radius: 4px;
            animation: highlightPulse 1.5s ease-in-out infinite;
        }
        
        @keyframes highlightPulse {
            0%, 100% { background-color: #ffd700; }
            50% { background-color: #ffec8b; }
        }
        
        #productNotes .match-highlight {
            background-color: rgba(76, 175, 80, 0.3) !important;
            box-shadow: 0 0 8px rgba(76, 175, 80, 0.4);
        }
        
        #productNotes .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 25px;
        }
        
        #productNotes .stats-card {
            background: var(--tool-bg);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        #productNotes .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(67, 97, 238, 0.2);
        }
        
        #productNotes .stats-icon {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            background: rgba(67, 97, 238, 0.15);
            font-size: 22px;
            color: var(--primary-color);
        }
        
        #productNotes .stats-content {
            flex: 1;
        }
        
        #productNotes .stats-value {
            font-size: 24px;
            font-weight: 800;
            color: var(--text-color);
            margin-bottom: 5px;
            background: linear-gradient(to right, #aab4e0, #fff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        #productNotes .stats-label {
            font-size: 14px;
            color: var(--text-color);
            opacity: 0.7;
            font-weight: 500;
        }
        
        #productNotes .footer {
            padding: 20px 30px;
            background-color: #1f2433;
            border-top: 1px solid var(--border-color);
            text-align: center;
            color: #6c757d;
            font-size: 14px;
            position: relative;
        }
        
        #productNotes .footer::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(to right, transparent, var(--primary-color), transparent);
        }
        
        #productNotes .table-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        #productNotes .search-box {
            position: relative;
            flex: 1;
            max-width: 400px;
        }
        
        #productNotes .search-box input {
    padding: 14px 20px 14px 45px;
    border-radius: 10px;
    border: 1px solid var(--border-color);
    background: var(--tool-bg);
    color: var(--text-color);
    width: 100%;
    font-size: 16px;
    transition: all 0.3s ease;
}
        
        #productNotes .search-box input:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(var(--primary-color-rgb), 0.3);
    outline: none;
}
        
        #productNotes .search-box i {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-color);
            font-size: 18px;
        }
        
        #productNotes .path-hint {
            font-size: 13px;
                color: var(--text-color);
                opacity: 0.7;
            margin-top: 8px;
            font-style: italic;
        }
        
        .folder-path-display {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
            color: #aab4e0;
            font-size: 14px;
        }
        
        /* Modal styles */
        #productNotes .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(8px);
        }
        
        #productNotes .modal-content {
            background: var(--tool-bg);
            border-radius: 16px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 0;
            position: relative;
            border: 1px solid var(--border-color);
            scrollbar-width: none;
        }
        
        #productNotes .modal-content::-webkit-scrollbar {
            display: none;
        }
        
       #productNotes .modal-header {
            padding: 5px 30px;
            background: linear-gradient(135deg, var(--primary-color) 0%, #7209b7 100%);
            border-radius: 16px 16px 0 0;
            position: relative;
            overflow: hidden;
        }
        
        #productNotes .modal-header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 90% 10%, rgba(255,255,255,0.1) 0%, transparent 70%);
            pointer-events: none;
        }
        
        #productNotes .modal-title {
            font-size: 26px;
            font-weight: 700;
            color: white;
            position: relative;
            z-index: 2;
        }
        
        #productNotes .close-modal {
            position: relative;
            top: 0px;
            right: 0px;
            background: none;
            border: none;
            color: rgba(255,255,255,0.8);
            font-size: 28px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            z-index: 2;
        }
        
        #productNotes .close-modal:hover {
            color: white;
            background: rgba(255,255,255,0.15);
        }
        
        #productNotes .modal-body {
            padding: 25px;
        }
        
        #productNotes .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        #productNotes .form-group {
            margin-bottom: 20px;
        }
        
        #productNotes .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-color);
    opacity: 0.9;
            font-size: 16px;
        }
        
        #productNotes .form-control {
            width: 100%;
            padding: 14px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: var(--tool-bg);
            color: var(--text-color);
        }
        
        #productNotes .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.3);
            background: var(--tool-bg);
        }
        
        #productNotes .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 15px;
            padding-top: 20px;
            border-top: 1px solid rgba(67, 97, 238, 0.2);
        }
        
        #productNotes .btn-cancel {
            background: rgba(var(--primary-color-rgb), 0.1);
            color: var(--text-color);
            padding: 12px 20px;
        }
        
        #productNotes .btn-cancel:hover {
            background: rgba(255,255,255,0.2);
        }
        
        #productNotes .btn-save {
            background: linear-gradient(to right, #4caf50, #449d48);
            color: white;
            padding: 12px 25px;
        }
        
        #productNotes .btn-save:hover {
            background: linear-gradient(to right, #449d48, #3d8b40);
        }

/* Updated no-products state */
        #productNotes .no-products {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            text-align: center;
             background: var(--tool-bg);
            border-radius: 12px;
            margin-top: 20px;
            border: 2px dashed var(--border-color);
            min-height: 300px;
        }
        
        #productNotes .no-products i {
            font-size: 20px;
        }

        #productNotes .no-products h3,
#productNotes .no-products p {
    color: var(--text-color);
}

        #productNotes .no-products h3 {
            margin-bottom: 15px;
            color: var(--text-color);
            font-size: 26px;
            font-weight: 600;
        }
        
        #productNotes .no-products p {
            margin-bottom: 25px;
            color: #aab4e0;
            font-size: 18px;
            max-width: 500px;
            line-height: 1.6;
        }
        
        /* Smaller button for no-products state */
        #productNotes .btn-sm {
            padding: 10px 20px;
            font-size: 15px;
        }
        
        #productNotes .glow {
            animation: glowEffect 2s infinite alternate;
        }
        
        @keyframes glowEffect {
            from {
                box-shadow: 0 0 5px rgba(67, 97, 238, 0.5);
            }
            to {
                box-shadow: 0 0 20px rgba(67, 97, 238, 0.8);
            }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            #productNotes .table-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            #productNotes .search-box {
                max-width: 100%;
            }
            
            #productNotes .controls {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            #productNotes .btn {
                padding: 10px 15px;
                font-size: 14px;
            }
            
            #productNotes .modal-body {
                padding: 20px;
            }
            
            #productNotes .form-row {
                grid-template-columns: 1fr;
            }
            
            #productNotes .modal-body {
                padding: 15px;
            }
            
            #productNotes .form-actions {
                padding-top: 15px;
                margin-top: 10px;
            }
        }
        
        /* Action buttons mini style */
        #productNotes.action-btn.mini {
            width: 30px;
            height: 30px;
            font-size: 14px;
        }
        
        /* Updated column widths */
        #productNotes .product-table th:nth-child(1),
        #productNotes .product-table td:nth-child(1) {
            width: 20%;
        }
        
        #productNotes .product-table th:nth-child(2),
        #productNotes .product-table td:nth-child(2) {
            width: 25%;
        }
        
        #productNotes .product-table th:nth-child(3),
        #productNotes .product-table td:nth-child(3) {
            width: 8%;
        }
        
        #productNotes .product-table th:nth-child(4),
        #productNotes .product-table td:nth-child(4) {
            width: 8%;
        }
        
        #productNotes .product-table th:nth-child(5),
        #productNotes .product-table td:nth-child(5) {
            width: 7%;
        }
        
        #productNotes .product-table th:nth-child(6),
        #productNotes .product-table td:nth-child(6) {
            width: 8%;
        }
        
        #productNotes .product-table th:nth-child(7),
        #productNotes .product-table td:nth-child(7) {
            width: 8%;
        }
        
        #productNotes .product-table th:nth-child(8),
        #productNotes .product-table td:nth-child(8) {
            width: 8%;
        }
        
        /* Folder row colspan fix */
        #productNotes .folder-row td {
            padding-left: 15px !important;
        }
        
        /* Folder hierarchy visualization */
        #productNotes .folder-hierarchy {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            width: 20px;
            background: linear-gradient(to right, rgba(67, 97, 238, 0.15), transparent);
            pointer-events: none;
        }
        
        #productNotes .folder-row .folder-toggle {
            position: relative;
            z-index: 2;
            
        }
        
        #productNotes .folder-row .folder-icon {
            position: relative;
            z-index: 2;
        }
        
        #productNotes .folder-row .folder-name {
            position: relative;
            z-index: 2;
        }
        
        /* Product hierarchy visualization */
        #productNotes .product-row .folder-indent {
            display: inline-block;
            width: 20px;
            height: 100%;
            background: linear-gradient(to right, rgba(67, 97, 238, 0.1), transparent);
            position: absolute;
            left: 0;
            top: 0;
            pointer-events: none;
        }
        
        /* Improved folder icons */
        #productNotes .folder-icon-top {
            color: #ffd700 !important;
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
        }
        
        #productNotes .folder-icon-sub {
            color: var(--primary-color) !important;
    text-shadow: 0 0 8px rgba(var(--primary-color-rgb), 0.3);
        }
        
        #productNotes .folder-icon-deep {
            color: #f44336 !important;
            text-shadow: 0 0 8px rgba(244, 67, 54, 0.5);
        }
            @keyframes slideDown {
    from { transform: translate(-50%, -100%); opacity: 0; }
    to { transform: translate(-50%, 0); opacity: 1; }
}

@keyframes slideUp {
    from { transform: translate(-50%, 0); opacity: 1; }
    to { transform: translate(-50%, -100%); opacity: 0; }
}

#productNotes .description-column {
    max-width: 200px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Style for description tooltip on hover */
#productNotes .description-column:hover {
    position: relative;
}

#productNotes .description-column:hover::after {
    content: attr(title);
    position: absolute;
    left: 0;
    top: 100%;
    z-index: 1000;
    background: var(--bg-color);
    padding: 5px 10px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    white-space: normal;
    max-width: 300px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}






    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/diff-match-patch/20121119/diff_match_patch.js"></script>
</head>
<body data-theme="dark">
    <div class="header">
        <div class="logo-container">
            <svg class="logo" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                <path fill="#056dce" d="M269.5,-0.5 C269.833,-0.5 270.167,-0.5 270.5,-0.5C 270.5,39.8333 270.5,80.1667 270.5,120.5C 299.169,120.333 327.835,120.5 356.5,121C 318.127,190.247 279.627,259.414 241,328.5C 240.5,289.168 240.333,249.835 240.5,210.5C 211.831,210.667 183.165,210.5 154.5,210C 193.227,140.046 231.56,69.8798 269.5,-0.5 Z M239.5,118.5 C240.494,128.987 240.828,139.654 240.5,150.5C 261.836,150.333 283.169,150.5 304.5,151C 292.953,170.59 281.787,190.424 271,210.5C 270.5,200.506 270.334,190.506 270.5,180.5C 249.164,180.667 227.831,180.5 206.5,180C 218.161,159.844 229.161,139.344 239.5,118.5 Z"/>
                <path fill="currentColor" d="M-0.5,120.5 C29.8333,120.5 60.1667,120.5 90.5,120.5C90.3333,177.501 90.5,234.501 91,291.5C91.6667,292.167 92.3333,292.833 93,293.5C107.014,279.319 121.181,265.319 135.5,251.5C175.86,291.194 215.86,331.194 255.5,371.5C295.14,331.194 335.14,291.194 375.5,251.5C389.819,265.319 403.986,279.319 418,293.5C418.667,292.833 419.333,292.167 420,291.5C420.5,234.501 420.667,177.501 420.5,120.5C450.833,120.5 481.167,120.5 511.5,120.5C511.5,193.833 511.5,267.167 511.5,340.5C509.183,350.933 505.349,360.933 500,370.5C471.307,417.224 443.141,464.224 415.5,511.5C308.833,511.5 202.167,511.5 95.5,511.5C67.8592,464.224 39.6925,417.224 11,370.5C5.65063,360.933 1.8173,350.933 -0.5,340.5C-0.5,267.167 -0.5,193.833 -0.5,120.5 Z"/>
            </svg>
        </div>
        <h1>Catalyst</h1>
        <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
    </div>

    <div class="tab" style="padding-left: 20px;">
        <button class="tablinks active" onclick="openTool(event, 'textCompare')">Text Compare</button>
        <button class="tablinks" onclick="openTool(event, 'caseConverter')">Case Converter</button>
        <button class="tablinks" onclick="openTool(event, 'loremGen')">Lorem Ipsum Generator</button>
        <button class="tablinks" onclick="openTool(event, 'spaceCheck')">Double Space Checker</button>
        <button class="tablinks" onclick="openTool(event, 'fileAnalyser')">File Analyser</button>
        <button class="tablinks" onclick="openTool(event, 'imageDiff')">Image Compare</button>
        <button class="tablinks" onclick="openTool(event, 'productNotes')">Notes</button>

    </div>

    <!-- Text Compare Tool -->
    <div id="textCompare" class="tabcontent" style="display: block;">
        <div class="tool-section">
            <div class="compare-container">
                <div class="text-input">
                    <h3>Original Text</h3>
                    <textarea id="text1"></textarea>
                </div>
                <div class="text-input">
                    <h3>Modified Text</h3>
                    <textarea id="text2"></textarea>
                </div>
            </div>
            <div style="text-align: center; margin: 20px 0; display: flex; justify-content: center; align-items: center; gap: 20px;">
                <button onclick="compareTexts()" style="background: var(--primary-color);">Compare Texts</button>
                <button onclick="clearAllTexts()" style="background: #f44336;">Clear All</button>
            </div>

        <div style="text-align: center; margin: 20px 0; display: flex; justify-content: center; align-items: center; gap: 20px;">
            <div id="matchIndicator" class="match-indicator" style="display: none;">
                <svg class="checkmark" viewBox="0 0 52 52">
                    <circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>
                    <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
                </svg>
                <span>Texts are identical!</span>
            </div>

        </div>
            <div class="compare-container">
                <div class="text-input">
                    <h3>Original Version</h3>
                    <div id="result1" class="result"></div>
                </div>
                <div class="text-input">
                    <h3>Modified Version</h3>
                    <div id="result2" class="result"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Case Converter Tool -->
    <div id="caseConverter" class="tabcontent">
        <div class="tool-section">
            <div class="input-output-section">
                <textarea id="caseInput" placeholder="Enter text to convert"></textarea>
                <div class="case-stats" id="caseCounts">
                    Character Count: 0 | Word Count: 0 | Sentence Count: 0 | Line Count: 0
                </div>
                <div class="text-input">
                    <h3>Converted Text</h3>
                    <div id="caseOutput" class="result"></div>
                </div>
            </div>
            
            <div class="button-section">
        
                <h5>Convert types</h5>
                <div class="case-buttons">
                    
                    <button data-type="lowercase">lowercase</button>
                    <button data-type="uppercase">UPPERCASE</button>
                    <button data-type="title_case">Title Case</button>
                    <button data-type="sentence_case">Sentence case</button>
                    <button data-type="inverse_case">Inverse Case</button>
                    <button data-type="alternating_case">Alternating Case</button>
                    <button data-type="slug">URL Slug</button>
                    <button data-type="underscore">Underscore</button>
                    <button data-type="remove_spaces">Remove Spaces</button>
                    <button data-type="reverse">Reverse Text</button>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="doubleSpaceCheck">
                    <label class="form-check-label" for="doubleSpaceCheck">Remove extra spaces</label>
                </div>
                <div class="action-buttons">
                    <button class="btn-success" id="copyButton">Copy to Clipboard</button>
                    <button class="btn-danger" id="clearButton">Clear All</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Lorem Ipsum Generator -->
    <div id="loremGen" class="tabcontent">
        <div class="tool-section">
            <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 20px;">
                <input type="range" id="paraCount" min="1" max="10" value="3" style="flex-grow: 1;">
                <span id="paraValue" style="min-width: 120px;">3 paragraphs</span>
                <button onclick="generateLorem()">Generate</button>
            </div>
            <div id="loremOutput" style="line-height: 1.6;"></div>
        </div>
    </div>

    <!-- Space Check Tool -->
    <div id="spaceCheck" class="tabcontent">
        <div class="tool-section">
            <textarea id="spaceInput" placeholder="Enter text to check"></textarea>
            <button onclick="checkSpaces()" style="margin: 15px 0;">Check Spaces</button>
            <div id="spaceResult" style="padding: 15px; background: var(--tool-bg); border-radius: 6px;"></div>
        </div>
    </div>
   

    <!--File Analyser -->
    <div id="fileAnalyser" class="tabcontent">
        <div class="upload-controls upload-area">
            <h4>Drag & Drop ZIP File or Select ZIP file</h4>
            <input type="file" id="zipInput" accept=".zip" style="display: none;">
            <div class="control-row">
                <div class="upload-row">
                    <label for="zipInput" class="btn-upload">Select ZIP File</label>
                    <div class="progress-container">
                        <div id="zipName" class="filename-bar"></div>
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progressBar"></div>
                            <div class="loading-spinner" id="loadingSpinner"></div>
                            <div class="status-text" id="zipProgress"></div>
                        </div>
                    </div>
                    <button id="resetAnalyser" class="btn-reset" onclick="resetFileAnalyser()">Reset</button>
                </div>
            </div>
        </div>
        <!-- Add this inside your #fileAnalyser div, after the upload controls -->
    <div id="fileTable" style="display: none; margin-top: 15px;">
        <table class="compression-table">
            <thead>
    <tr>
        <th>Name</th>
                    <th>Format</th>
                    <th>Size</th>
                    <th>Dimensions</th>
                    <th>Duration</th>
                    <th>Color Mode</th>
    </tr>
</thead>
            <tbody id="fileAnalyserList"></tbody>
        </table>
    </div>
    </div>

<!-- Image Diff Tool -->
<div id="imageDiff" class="tabcontent">
    <div class="tool-section">
        <details class="upload-details">
            <summary>Upload Images</summary>
            <div class="upload-section">
                <div class="upload-container">
                    <div class="upload-box" id="upload1">
                        <input type="file" id="file1" accept="image/*" class="file-input">
                        <div class="upload-content">
                            <svg class="upload-icon" viewBox="0 0 24 24">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                            <div class="upload-text">
                                <h3>Image 1</h3>
                                <p>Drag & drop or click to upload</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="upload-box" id="upload2">
                        <input type="file" id="file2" accept="image/*" class="file-input">
                        <div class="upload-content">
                            <svg class="upload-icon" viewBox="0 0 24 24">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                            <div class="upload-text">
                                <h3>Image 2</h3>
                                <p>Drag & drop or click to upload</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </details>

        <div class="controls">
            <div class="blend-modes">
                <button data-mode="normal">Normal</button>
                <button data-mode="difference">Difference</button>
                <button data-mode="multiply">Multiply</button>
                <button data-mode="screen">Screen</button>
                <button id="swapLayers">Swap Layers</button>
                <button id="newCheck">Reset</button>
            </div>
            
        </div>

        <div id="error" class="hidden"></div>

        <div class="main-content">
            <div class="image-compare">
                <div class="zoom-controls">
                    <button id="zoomIn" title="Zoom In">+</button>
                    <button id="zoomOut" title="Zoom Out">−</button>
                    <button id="resetZoom" title="Reset Zoom">Reset</button>
                </div>
                <div class="image-viewer">
                    <div class="image-container">
                        <img id="imageBefore" class="image">
                        <img id="imageAfter" class="image">
                        <canvas id="differenceCanvas" class="hidden"></canvas>
                    </div>
                </div>
            </div>
            <div>
                
                <details class="advanced-settings">
                
                    <summary>Advanced Layer Settings</summary>
                    
                    <div class="layer-controls">
                        <div class="layer-item">
                            <div class="layer-header">
                                <span class="eye-icon">👁️</span>
                                <span>Layer 2</span>
                            </div>
                            <input type="range" class="opacity-slider" min="0" max="100" value="100">
                            <select class="blend-mode-select">
                                <option value="normal">Normal</option>
                                <option value="multiply">Multiply</option>
                                <option value="screen">Screen</option>
                                <option value="overlay">Overlay</option>
                                <option value="difference">Difference</option>
                                <option value="color-dodge">Color Dodge</option>
                                <option value="color-burn">Color Burn</option>
                                <option value="hard-light">Hard Light</option>
                                <option value="soft-light">Soft Light</option>
                                <option value="exclusion">Exclusion</option>
                            </select>
                        </div>
                        <div class="layer-item">
                            <div class="layer-header">
                                <span class="eye-icon">👁️</span>
                                <span>Layer 1</span>
                            </div>
                            <input type="range" class="opacity-slider" min="0" max="100" value="100">
                            <select class="blend-mode-select">
                                <option value="normal">Normal</option>
                                <option value="multiply">Multiply</option>
                                <option value="screen">Screen</option>
                                <option value="overlay">Overlay</option>
                                <option value="difference">Difference</option>
                                <option value="color-dodge">Color Dodge</option>
                                <option value="color-burn">Color Burn</option>
                                <option value="hard-light">Hard Light</option>
                                <option value="soft-light">Soft Light</option>
                                <option value="exclusion">Exclusion</option>
                            </select>
                        </div>
                    </div>
                </details>
                <div class="file-details">
                    <div class="file-info" id="file1Details"></div>
                    <div class="file-info" id="file2Details"></div>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- NOTES TOOL -->
    <div id="productNotes" class="tabcontent">
    <div class="app-container">
        <div class="main-content">
            <div class="table-controls">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="productSearch" placeholder="Search products or folders...">
                </div>
                <div class="controls">
                    <button class="btn btn-primary glow" id="newProductBtn">
                        <i class="fas fa-plus"></i> Add Product
                    </button>
                    <button class="btn btn-outline" id="importBtn">
                        <i class="fas fa-file-import"></i> Import
                    </button>
                    <button class="btn btn-outline" id="exportBtn">
                        <i class="fas fa-file-export"></i> Export
                    </button>
                    <button class="btn btn-edit" id="editToggle">
                        <i class="fas fa-edit"></i> Edit Mode
                    </button>
                </div>
            </div>
                
                <div class="table-container">
                    <table class="product-table" id="productsTable">
                        <thead>
    <tr>
        <th>Name</th>
        <th>Dimensions</th>
        <th>File Size</th>
        <th>Format</th>
        <th>Bit Rate</th>
        <th>Duration</th>
        <th>FPS</th>
        <th class="description-column">Description</th>
        <th class="actions-column">Actions</th>
    </tr>
</thead>
                        <tbody id="productsContainer">
                            <!-- Folder and product rows will be generated here -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Enhanced empty state -->
                <div class="no-products" id="noProductsState" style="display: none;">
                    <i class="fas fa-box-open"></i>
                    <h3>No Products Found</h3>
                    <p>Try adjusting your search or add new products to get started</p>
                    <button class="btn btn-primary glow" id="addFromEmptyBtn">
                        <i class="fas fa-plus"></i> Add New Product
                    </button>
                </div>
                <button class="stats-toggle collapsed" onclick="toggleStats(this)">Statistics Overview</button>
                <!-- Stats container -->
                <div class="stats-container" id="statsContainer">
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-folder"></i>
                        </div>
                        <div class="stats-content">
                            <div class="stats-value" id="folderCount">0</div>
                            <div class="stats-label">Active Folders</div>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-box"></i>
                        </div>
                        <div class="stats-content">
                            <div class="stats-value" id="totalProducts">0</div>
                            <div class="stats-label">Total Products</div>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="stats-content">
                            <div class="stats-value" id="storageUsed">0 KB</div>
                            <div class="stats-label">Storage Used</div>
                        </div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <div class="stats-content">
                            <div class="stats-value" id="searchMatches">0</div>
                            <div class="stats-label">Search Matches</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal for product editing -->
        <div class="modal-overlay" id="modalOverlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="formTitle">New Product</h2>
                    <button class="close-modal" id="closeModal">&times;</button>
                </div>
                
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productName">Product Name</label>
                            <input type="text" class="form-control" id="productName" placeholder="Enter product name">
                        </div>
                        <div class="form-group">
                            <label for="dimensions">Dimensions</label>
                            <input type="text" class="form-control" id="dimensions" placeholder="e.g. 1920x1080">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fileSize">File Size Limit</label>
                            <input type="text" class="form-control" id="fileSize" placeholder="e.g. 100MB">
                        </div>
                        <div class="form-group">
                            <label for="format">Format</label>
                            <input type="text" class="form-control" id="format" placeholder="e.g. MP4">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bitrate">Bit Rate</label>
                            <input type="text" class="form-control" id="bitrate" placeholder="e.g. 5 Mbps">
                        </div>
                        <div class="form-group">
                            <label for="duration">Duration</label>
                            <input type="text" class="form-control" id="duration" placeholder="e.g. 2:30">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fps">FPS (Videos)</label>
                            <input type="text" class="form-control" id="fps" placeholder="e.g. 30">
                        </div>
                        <div class="form-group">
                            <label for="folderPath">Folder Path</label>
                            <input type="text" class="form-control" id="folderPath" placeholder="e.g. Media/Video Products">
                            <div class="path-hint">Use forward slashes (/) to create nested folders</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea class="form-control" id="description" rows="4" placeholder="Enter comments and additional information" style="height: 80px;"></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button class="btn btn-cancel" id="cancelEdit">Cancel</button>
                        <button class="btn btn-save" id="saveProduct">Save Product</button>
                    </div>
                </div>
            </div>
        </div>
    </div>





    <script>
        // Verify libraries are loaded
        window.addEventListener('load', function() {
            // Check JSZip
            if (typeof JSZip === 'undefined') {
                console.error('JSZip not loaded. File Analyser will not work.');
                document.getElementById('fileAnalyser').innerHTML = 
                    '<div class="error-message">Error: Required library not loaded. Please refresh the page.</div>';
            }
        
            // Check image compression library
            if (typeof imageCompression === 'undefined') {
                console.error('Image compression library not loaded');
                document.getElementById('imageCompressor').innerHTML = 
                    '<div class="error-message">Error: Required library not loaded. Please refresh the page.</div>';
            }
        
            // Check diff match patch
            if (typeof diff_match_patch === 'undefined') {
                console.error('Diff Match Patch library not loaded');
                document.getElementById('textCompare').innerHTML = 
                    '<div class="error-message">Error: Required library not loaded. Please refresh the page.</div>';
            }
        });
        </script>
    <script>
        // Theme management
        function toggleTheme() {
            const body = document.body;
            body.setAttribute('data-theme', 
                body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
                
        }
        

        // Tab management
        function openTool(evt, toolName) {
            const tabcontent = document.getElementsByClassName("tabcontent");
            const tablinks = document.getElementsByClassName("tablinks");
            
            for (let tab of tabcontent) tab.style.display = "none";
            for (let link of tablinks) link.classList.remove("active");
            
            document.getElementById(toolName).style.display = "block";
            evt.currentTarget.classList.add("active");
        }

          // Modified compareTexts function
          function compareTexts() {
    const text1 = document.getElementById('text1').value;
    const text2 = document.getElementById('text2').value;
    const matchIndicator = document.getElementById('matchIndicator');

    // Initialize diff tracker
    const dmp = new diff_match_patch();
    
    // Normalize line breaks
    const text1Normalized = text1.replace(/(\r\n|\r)/g, '\n');
    const text2Normalized = text2.replace(/(\r\n|\r)/g, '\n');

    // Get character differences
    const diffs = dmp.diff_main(text1Normalized, text2Normalized);
    dmp.diff_cleanupSemantic(diffs);

    // Process differences and update UI
    let html1 = '';
    let html2 = '';
    let hasChanges = false;
    
    diffs.forEach(([change, text]) => {
        text = text.replace(/&/g, '&amp;')
                  .replace(/</g, '&lt;')
                  .replace(/>/g, '&gt;');
        
        const replacedText = text.replace(/\n/g, '<span class="linebreak">\↵</span><br>');

        if (change !== 0) hasChanges = true;

        switch(change) {
            case -1:
                html1 += `<span class="deleted">${replacedText}</span>`;
                break;
            case 1:
                html2 += `<span class="added">${replacedText}</span>`;
                break;
            case 0:
                html1 += replacedText;
                html2 += replacedText;
                break;
        }
    });

    // Update results
    document.getElementById('result1').innerHTML = html1;
    document.getElementById('result2').innerHTML = html2;

    // Show/hide match indicator
    matchIndicator.style.display = hasChanges ? 'none' : 'flex';
}

function clearAllTexts() {
    document.getElementById('text1').value = '';
    document.getElementById('text2').value = '';
    document.getElementById('result1').innerHTML = '';
    document.getElementById('result2').innerHTML = '';
    document.getElementById('matchIndicator').style.display = 'none';
}

        // Case Converter Logic
        const converters = {
            lowercase: text => text.toLowerCase(),
            uppercase: text => text.toUpperCase(),
            title_case: text => text.replace(/\w\S*/g, txt => txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()),
            sentence_case: text => text.replace(/(^\s*\w|[.?!]\s*\w)/g, txt => txt.toUpperCase()),
            capitalize: text => text.replace(/\b\w/g, char => char.toUpperCase()),
            inverse_case: text => [...text].map(char => (char === char.toUpperCase() ? char.toLowerCase() : char.toUpperCase())).join(''),
            alternating_case: text => [...text].map((char, i) => (i % 2 === 0 ? char.toUpperCase() : char.toLowerCase())).join(''),
            slug: text => text.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, ''),
            underscore: text => text.replace(/[^a-zA-Z0-9]+/g, '_').replace(/^_|_$/g, ''),
            remove_spaces: text => text.replace(/\s+/g, ''),
            reverse: text => [...text].reverse().join('')
        };

        document.addEventListener('DOMContentLoaded', function() {
            const caseInput = document.getElementById('caseInput');
            const caseOutput = document.getElementById('caseOutput');
            const caseButtons = document.querySelector('.case-buttons');
            const copyButton = document.getElementById('copyButton');
            const clearButton = document.getElementById('clearButton');
            const doubleSpaceCheck = document.getElementById('doubleSpaceCheck');
            const caseCounts = document.getElementById('caseCounts');

            function updateStats() {
                const text = caseInput.value;
                const charCount = text.length;
                const wordCount = text.trim().split(/\s+/).filter(Boolean).length;
                const sentenceCount = text.split(/[.?!]+/).filter(Boolean).length;
                const lineCount = text.split('\n').length;
                caseCounts.textContent = `Character Count: ${charCount} | Word Count: ${wordCount} | Sentence Count: ${sentenceCount} | Line Count: ${lineCount}`;
            }

            caseInput.addEventListener('input', updateStats);

            caseButtons.addEventListener('click', function(e) {
                if (e.target.tagName === 'BUTTON') {
                    let type = e.target.dataset.type;
                    let text = caseInput.value;

                    if (doubleSpaceCheck.checked) {
                        text = text.replace(/\s+/g, ' ');
                    }

                    if (converters[type]) {
                        caseOutput.textContent = converters[type](text);
                    }
                }
            });

            copyButton.addEventListener('click', function() {
                navigator.clipboard.writeText(caseOutput.textContent).then(() => {
                    alert('Text copied to clipboard!');
                }).catch(err => {
                    console.error('Failed to copy text: ', err);
                });
            });

            clearButton.addEventListener('click', function() {
                caseInput.value = '';
                caseOutput.textContent = '';
                updateStats();
            });
        });

        // Lorem Ipsum Generator Logic
        function generateLorem() {
            const paraCount = document.getElementById('paraCount').value;
            const loremOutput = document.getElementById('loremOutput');
            let loremText = '';
            
            for (let i = 0; i < paraCount; i++) {
                loremText += generateParagraph() + '<br><br>';
            }
            
            loremOutput.innerHTML = loremText;
        }

        function generateParagraph() {
            const sentences = [
                "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
                "Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",
                "Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
                "Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.",
                "Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."
            ];
            
            let paragraph = '';
            const sentenceCount = Math.floor(Math.random() * 5) + 3; // Random number of sentences between 3 and 7
            
            for (let i = 0; i < sentenceCount; i++) {
                paragraph += sentences[Math.floor(Math.random() * sentences.length)] + ' ';
            }
            
            return paragraph;
        }

        document.addEventListener('DOMContentLoaded', function() {
            const paraCountInput = document.getElementById('paraCount');
            const paraValueSpan = document.getElementById('paraValue');

            paraCountInput.addEventListener('input', function() {
                paraValueSpan.textContent = this.value + ' paragraphs';
            });
        });

        // Space Check Tool Logic
        function checkSpaces() {
    const text = document.getElementById('spaceInput').value;
    
    // Find double spaces and count them
    const doubleSpaces = (text.match(/ {2,}/g) || []).length;
    
    // Process text for both highlighting and cleaning
    const processed = text
        .replace(/\n/g, '<br>')
        .replace(/ {2,}/g, match => {
            return `<span class="highlight">${'·'.repeat(match.length)}</span>`;
        });
    
    // Clean text version (single spaces only)
    const cleanedText = text
        .replace(/\n/g, '<br>')
        .replace(/ {2,}/g, ' ');
    
    // Update the result display with horizontal layout
    document.getElementById('spaceResult').innerHTML = `
        <div style="margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
            <strong>Double spaces found: ${doubleSpaces}</strong>
            <div class="space-actions">
                <button onclick="clearSpaceChecker()" class="btn-danger">Clear All</button>
                <button onclick="copyText()" class="space-btn">Copy Text</button>
            </div>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div class="result-box">
                <strong>Original text with highlighted spaces</strong>
                <div class="text-content">
                    ${processed}
                </div>
            </div>
            <div class="result-box">
                <strong>Corrected text (single spaces)</strong>
                <div class="text-content" id="cleanedTextContent">
                    ${cleanedText}
                </div>
            </div>
        </div>
    `;
}

// Add helper functions
function clearSpaceChecker() {
    document.getElementById('spaceInput').value = '';
    document.getElementById('spaceResult').innerHTML = '';
}

function copyText() {
    const cleanedText = document.getElementById('cleanedTextContent').innerText;
    navigator.clipboard.writeText(cleanedText.replace(/<br>/g, '\n'))
        .then(() => {
            const copyBtn = document.querySelector('.space-btn:last-child');
            const originalText = copyBtn.textContent;
            copyBtn.textContent = 'Copied!';
            copyBtn.style.backgroundColor = '#4CAF50';
            setTimeout(() => {
                copyBtn.textContent = originalText;
                copyBtn.style.backgroundColor = 'var(--primary-color)';
            }, 2000);
        });
}


    <!-- File analyser-->
    function resetFileAnalyser() {
    // Clear the file input
    document.getElementById('zipInput').value = '';
    
    // Reset progress indicators
    document.getElementById('zipName').textContent = '';
    document.getElementById('zipProgress').textContent = '';
    document.getElementById('progressBar').style.width = '0';
    document.getElementById('loadingSpinner').style.display = 'none';
    
    // Clear the file table
    document.getElementById('fileTable').style.display = 'none';
    document.getElementById('fileAnalyserList').innerHTML = '';
    
    // Reset the structure Map
    structure.clear();
    
    // Deactivate reset button
    const resetButton = document.getElementById('resetAnalyser');
    resetButton.classList.remove('active');
}

// Modify ZIP file input event listener
document.getElementById('zipInput').addEventListener('change', async function(e) {
    // Activate reset button when file is selected
    const resetButton = document.getElementById('resetAnalyser');
    resetButton.classList.add('active');
    
    // ... rest of your existing code ...
});
// Drag and drop File Analyser code

// Get the upload area element
const zipDropZone = document.querySelector('#fileAnalyser .upload-controls');
const zipInput = document.getElementById('zipInput');

// Add dragover event
zipDropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    zipDropZone.classList.add('dragover');
});

// Add dragleave event
zipDropZone.addEventListener('dragleave', () => {
    zipDropZone.classList.remove('dragover');
});

// Add drop event
zipDropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    zipDropZone.classList.remove('dragover');
    
    const files = e.dataTransfer.files;
    if (files.length > 0 && files[0].name.toLowerCase().endsWith('.zip')) {
        // Update the file input
        const dataTransfer = new DataTransfer();
        dataTransfer.items.add(files[0]);
        zipInput.files = dataTransfer.files;
        
        // Trigger the change event
        zipInput.dispatchEvent(new Event('change'));
    } else {
        alert('Please drop a ZIP file');
    }
});

     // Make structure global so it's available in all functions
     let structure = new Map();

// Global renderFolder function
// Modify the renderFolder function to ignore macOS system folders and handle duplicates properly
function renderFolder(folderPath, level) {
    const tbody = document.getElementById('fileAnalyserList');
    let files = structure.get(folderPath) || []; // Add default empty array

    // Skip macOS system folders
    if (folderPath.includes('__MACOSX') || folderPath.includes('.DS_Store')) {
        return;
    }

    // Render folder row (if not the root)
    if (folderPath !== '') {
        const folderName = folderPath.split('/').filter(p => p).pop();
        
        // Skip if folder name starts with '.' or is a system folder
        if (folderName.startsWith('.') || folderName === '__MACOSX') {
            return;
        }

        const tr = document.createElement('tr');
        tr.className = 'folder';
        tr.dataset.path = folderPath;
        tr.innerHTML = `
            <td style="padding-left: ${level * 20}px">
                <span class="toggle">▶️</span> 📁 ${folderName}
            </td>
            <td>Folder</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
        `;
        tbody.appendChild(tr);
    }

    // Only try to render files if the array exists
    if (Array.isArray(files)) {
        // Filter and render files in the current folder
        files.forEach(file => {
            // Skip macOS system files and hidden files
            if (file.name.startsWith('.') || file.name === '.DS_Store') {
                return;
            }

            const tr = document.createElement('tr');
            tr.dataset.parent = folderPath;
            tr.dataset.filename = file.name;
            tr.className = folderPath === '' ? '' : 'hidden';
            
            tr.innerHTML = `
                <td style="padding-left: ${(level + 1) * 20}px">📄 ${file.name}</td>
                <td>${file.format}</td>
                <td>${formatBytes(file.size)}</td>
                <td>${file.dimensions}</td>
                <td>${file.duration}</td>
                <td>${file.colorMode}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    // Recursively render direct subfolders (excluding system folders)
    for (const [path, ] of structure.entries()) {
        if (
            path !== folderPath &&
            path.startsWith(folderPath) &&
            path.split('/').length === folderPath.split('/').length + 1 &&
            !path.includes('__MACOSX') &&
            !path.includes('.DS_Store')
        ) {
            renderFolder(path, level + 1);
        }
    }
}

// Event listener for ZIP file input
document.getElementById('zipInput').addEventListener('change', async function(e) {
    const file = e.target.files[0];
    if (!file) return;

    try {
        // Initialize ZIP progress
        updateZipProgress(file.name, 'Loading ZIP...', 10);
        
        // Verify JSZip is loaded
        if (typeof JSZip === 'undefined') {
            throw new Error('JSZip library not loaded');
        }

        const zip = await JSZip.loadAsync(file);
        const table = document.getElementById('fileTable');
        const tbody = document.getElementById('fileAnalyserList');
        
        if (!table || !tbody) {
            throw new Error('Required DOM elements not found');
        }

        tbody.innerHTML = '';
        table.style.display = 'table';

        // First pass: Build folder structure
        updateZipProgress(file.name, 'Building folder structure...', 30);
        for (const [relativePath, fileEntry] of Object.entries(zip.files)) {
            // Skip macOS system files and folders
            if (relativePath.includes('__MACOSX') || 
                relativePath.includes('.DS_Store') || 
                relativePath.startsWith('.')) {
                continue;
            }

            const pathParts = relativePath.split('/').filter(part => 
                part !== '' && 
                !part.startsWith('.') && 
                part !== '__MACOSX'
            );
            
            if (fileEntry.dir) {
                structure.set(relativePath, []);
                continue;
            }

            const parentPath = pathParts.length > 1
                ? pathParts.slice(0, -1).join('/') + '/'
                : '';

            if (!structure.has(parentPath)) {
                structure.set(parentPath, []);
            }

            const fileInfo = {
                path: relativePath,
                name: pathParts[pathParts.length - 1],
                format: relativePath.split('.').pop().toUpperCase() || '',
                size: fileEntry._data.uncompressedSize,
                dimensions: '-',
                duration: '-',
                colorMode: '-'
            };
            structure.get(parentPath).push(fileInfo);
        }

        // Render initial structure
        renderFolder('', 0);

        // Initialize arrays for promises
        const imagePromises = [];
        const videoPromises = [];

        // Second pass: Process files
        let processedFiles = 0;
        const totalFiles = Object.keys(zip.files).filter(key => !zip.files[key].dir).length;

        for (const [relativePath, fileEntry] of Object.entries(zip.files)) {
            if (!fileEntry.dir) {
                try {
                    const blob = await fileEntry.async('blob');
                    const url = URL.createObjectURL(blob);
                    const pathParts = relativePath.split('/');
                    const fileName = pathParts[pathParts.length - 1];
                    const parentPath = pathParts.length > 1 
                        ? pathParts.slice(0, -1).join('/') + '/'
                        : '';

                    processedFiles++;
                    const progress = Math.round((processedFiles / totalFiles) * 50) + 40;

                    if (fileName.match(/\.(jpe?g|png|gif|bmp)$/i)) {
                        updateZipProgress(file.name, `Processing images... (${processedFiles}/${totalFiles})`, progress);
                        imagePromises.push(processImage(url, parentPath, fileName));
                    } else if (fileName.match(/\.(mp4|webm|ogg|mov|avi)$/i)) {
                        updateZipProgress(file.name, `Processing videos... (${processedFiles}/${totalFiles})`, progress);
                        videoPromises.push(processVideo(url, parentPath, fileName));
                    }
                } catch (error) {
                    console.error(`Error processing ${relativePath}:`, error);
                }
            }
        }

        // Wait for all image processing to complete
        if (imagePromises.length > 0) {
            updateZipProgress(file.name, 'Processing images...', 90);
            await Promise.all(imagePromises);
        }

        // Wait for all video processing to complete
        if (videoPromises.length > 0) {
            updateZipProgress(file.name, 'Processing videos...', 95);
            await Promise.all(videoPromises);
        }

        updateZipProgress(file.name, 'Analysis complete ✓', 100);

    } catch (error) {
        console.error('Detailed error:', error);
        updateZipProgress(file.name, `Error: ${error.message}`, 100);
    }
});

// Add helper function for formatting duration
function formatDuration(seconds) {
    const hrs = Math.floor(seconds / 3600);
    const mins = Math.floor((seconds % 3600) / 60);
    const secs = Math.floor(seconds % 60);
    
    const parts = [];
    
    if (hrs > 0) {
        parts.push(String(hrs).padStart(2, '0'));
    }
    
    parts.push(String(mins).padStart(2, '0'));
    parts.push(String(secs).padStart(2, '0'));
    
    return parts.join(':');
}

// Folder click handler for toggling subfolder visibility
document.getElementById('fileAnalyserList').addEventListener('click', (e) => {
    const folderRow = e.target.closest('.folder');
    if (folderRow) {
        folderRow.classList.toggle('expanded');
        const folderPath = folderRow.dataset.path;
        const childRows = document.querySelectorAll(`tr[data-parent="${folderPath}"]`);
        childRows.forEach(row => row.classList.toggle('hidden'));
    }
});

// Helper functions
function processImage(url, parentPath, fileName) {
    return new Promise((resolve) => {
        const img = new Image();
        img.onload = () => {
            const colorMode = fileName.toLowerCase().endsWith('.png') ? 'RGBA' : 'RGB';
            const dimensions = `${img.naturalWidth}x${img.naturalHeight}`;
            
            // Find the row by both parent path and filename
            const row = findFileRow(parentPath, fileName);
            if (row) {
                row.querySelector('td:nth-child(4)').textContent = dimensions;
                row.querySelector('td:nth-child(6)').textContent = colorMode;
            }
            
            URL.revokeObjectURL(url);
            resolve();
        };
        img.onerror = () => {
            console.error(`Failed to load image: ${fileName}`);
            URL.revokeObjectURL(url);
            resolve();
        };
        img.src = url;
    });
}

function findFileRow(parentPath, fileName) {
    // Handle both root-level files and files in folders
    const selector = parentPath === '' 
        ? `tr[data-parent=""][data-filename="${fileName}"]`
        : `tr[data-parent="${parentPath}"][data-filename="${fileName}"]`;
    return document.querySelector(selector);
}

function updateFileInfo(parentPath, fileName, info) {
    const row = findFileRow(parentPath, fileName);
    if (row) {
        if (info.dimensions) {
            row.querySelector('td:nth-child(4)').textContent = info.dimensions;
        }
        if (info.duration) {
            row.querySelector('td:nth-child(5)').textContent = info.duration;
        }
        if (info.colorMode) {
            row.querySelector('td:nth-child(6)').textContent = info.colorMode;
        }
    } else {
        console.warn(`Row not found for file: ${fileName} in path: ${parentPath}`);
    }
}

function processVideo(url, parentPath, fileName) {
    return new Promise((resolve) => {
        const video = document.createElement('video');
        
        // Add metadata loading handler
        video.addEventListener('loadedmetadata', () => {
            const duration = formatDuration(video.duration);
            const dimensions = `${video.videoWidth}x${video.videoHeight}`;
            
            // Find the row and update both duration and dimensions
            const row = findFileRow(parentPath, fileName);
            if (row) {
                row.querySelector('td:nth-child(4)').textContent = dimensions;
                row.querySelector('td:nth-child(5)').textContent = duration;
            }
            
            URL.revokeObjectURL(url);
            resolve();
        });

        // Add error handler
        video.addEventListener('error', () => {
            console.error(`Error loading video: ${fileName}`);
            URL.revokeObjectURL(url);
            resolve();
        });

        // Set video source and force metadata loading
        video.preload = 'metadata';
        video.src = url;

        // Force the video to load metadata
        video.load();
    });
}

function formatBytes(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

function updateZipProgress(filename, status = '', progress = 0) {
    const zipName = document.getElementById('zipName');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('zipProgress');
    const loadingSpinner = document.getElementById('loadingSpinner');

    // Update filename
    zipName.textContent = filename;

    // Update progress bar and status
    progressBar.style.width = `${progress}%`;
    progressText.textContent = status;

    // Show/hide loading spinner
    if (status.includes('Processing') || status.includes('Loading')) {
        loadingSpinner.style.display = 'block';
    } else {
        loadingSpinner.style.display = 'none';
    }

    // Add status-specific styling
    if (status.includes('complete')) {
        progressBar.style.width = '100%';
        progressBar.style.backgroundColor = '#4CAF50';
    } else if (status.includes('Error')) {
        progressBar.style.backgroundColor = '#f44336';
    } else {
        progressBar.style.backgroundColor = 'var(--primary-color)';
    }
}
// File analyser Table filter
function addFilterHeader() {
    const thead = document.querySelector('#fileTable thead');
    const filterRow = document.createElement('tr');
    filterRow.className = 'filter-row';
    
    filterRow.innerHTML = `
        <th>
            <input type="text" class="column-filter" data-column="name" placeholder="Filter name...">
        </th>
        <th>
            <input type="text" class="column-filter" data-column="format" placeholder="Filter format...">
        </th>
        <th>
            <div class="size-filter">
                <select class="filter-operator">
                    <option value="=">Equal to</option>
                    <option value=">" selected>Greater than</option>
                    <option value="<">Less than</option>
                    <option value=">=">Greater or equal</option>
                    <option value="<=">Less or equal</option>
                </select>
                <input type="number" class="size-value" value="200" placeholder="Size">
                <select class="size-unit">
                    <option value="B">B</option>
                    <option value="KB" selected>KB</option>
                    <option value="MB">MB</option>
                    <option value="GB">GB</option>
                </select>
            </div>
        </th>
        <th>
            <input type="text" class="column-filter" data-column="dimensions" placeholder="Filter dimensions...">
        </th>
        <th>
            <input type="text" class="column-filter" data-column="duration" placeholder="Filter duration...">
        </th>
        <th style="position: relative;">
            <input type="text" class="column-filter" data-column="colorMode" placeholder="Filter color mode...">
            <button id="resetFilters" onclick="resetFilters()" 
                    style="position: absolute; right: -100px; top: 50%; transform: translateY(-50%); 
                           opacity: 0.5; pointer-events: none;">
                Reset Filters
            </button>
        </th>
    `;
    
    thead.appendChild(filterRow);
}

// Add this new function to reset all filters
function resetFilters() {
    // Reset all filter inputs
    document.querySelectorAll('.column-filter').forEach(input => {
        input.value = '';
    });
    
    // Reset size filter
    document.querySelector('.filter-operator').value = '>';
    document.querySelector('.size-value').value = '200';
    document.querySelector('.size-unit').value = 'KB';
    
    // Reset all row styles
    const rows = document.querySelectorAll('#fileAnalyserList tr:not(.folder)');
    rows.forEach(row => {
        row.style.backgroundColor = '';
        row.style.color = 'var(--text-color)';
    });
    
    // Update reset button state
    const resetButton = document.getElementById('resetFilters');
    if (resetButton) {
        resetButton.style.opacity = '0.5';
        resetButton.style.pointerEvents = 'none';
    }
}
// Helper functions for duration conversion
function convertDurationToSeconds(durationStr) {
    const parts = durationStr.split(':').map(Number);
    if (parts.length === 3) {
        return parts[0] * 3600 + parts[1] * 60 + parts[2];
    }
    if (parts.length === 2) {
        return parts[0] * 60 + parts[1];
    }
    return parts[0];
}

function convertInputToSeconds(value, unit) {
    switch (unit) {
        case 'h': return value * 3600;
        case 'm': return value * 60;
        case 's': return value;
        default: return value;
    }
}
// Add these functions for sorting and filtering
let currentSort = { column: null, direction: 'asc' };

function handleSort(th) {
    const column = th.cellIndex;
    const table = document.getElementById('fileTable');
    const tbody = table.querySelector('tbody');
    const rows = Array.from(tbody.querySelectorAll('tr:not(.folder)'));
    
    // Update sort direction
    if (currentSort.column === column) {
        currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
    } else {
        currentSort.column = column;
        currentSort.direction = 'asc';
    }
    
    // Update sort icons
    table.querySelectorAll('th').forEach(header => header.classList.remove('sorted-asc', 'sorted-desc'));
    th.classList.add(currentSort.direction === 'asc' ? 'sorted-asc' : 'sorted-desc');
    
    // Sort rows
    rows.sort((a, b) => {
        let aVal = a.cells[column].textContent;
        let bVal = b.cells[column].textContent;
        
        // Special handling for size column
        if (column === 2) {
            aVal = convertToBytes(aVal);
            bVal = convertToBytes(bVal);
        }
        
        if (aVal === bVal) return 0;
        const comparison = aVal > bVal ? 1 : -1;
        return currentSort.direction === 'asc' ? comparison : -comparison;
    });
    
    // Reattach sorted rows
    rows.forEach(row => tbody.appendChild(row));
}

function convertToBytes(sizeStr) {
    const units = { 'B': 1, 'KB': 1024, 'MB': 1024 * 1024, 'GB': 1024 * 1024 * 1024 };
    const matches = sizeStr.match(/^([\d.]+)\s*([KMGT]?B)$/i);
    if (!matches) return 0;
    return parseFloat(matches[1]) * units[matches[2].toUpperCase()];
}

function filterTable() {
    const tbody = document.getElementById('fileAnalyserList');
    const rows = tbody.querySelectorAll('tr:not(.folder)');
    const filters = {
        name: document.querySelector('[data-column="name"]').value.toLowerCase(),
        format: document.querySelector('[data-column="format"]').value.toLowerCase(),
        size: {
            operator: document.querySelector('.filter-operator').value,
            value: document.querySelector('.size-value').value,
            unit: document.querySelector('.size-unit').value
        },
        dimensions: document.querySelector('[data-column="dimensions"]').value.toLowerCase(),
        duration: document.querySelector('[data-column="duration"]').value.toLowerCase(),
        colorMode: document.querySelector('[data-column="colorMode"]').value.toLowerCase()
    };
    
    // Check if any filter is active
    const hasActiveFilter = filters.name || filters.format || filters.dimensions || 
                          filters.duration || filters.colorMode || filters.size.value;
    
    // Update reset button state
    const resetButton = document.getElementById('resetFilters');
    if (resetButton) {
        resetButton.style.opacity = hasActiveFilter ? '1' : '0.5';
        resetButton.style.pointerEvents = hasActiveFilter ? 'auto' : 'none';
    }
    
    rows.forEach(row => {
        let matches = true;
        
        // Name filter
        if (filters.name && !row.cells[0].textContent.toLowerCase().includes(filters.name)) {
            matches = false;
        }
        
        // Format filter
        if (filters.format && !row.cells[1].textContent.toLowerCase().includes(filters.format)) {
            matches = false;
        }
        
        // Size filter
        if (filters.size.value) {
            const sizeText = row.cells[2].textContent;
            const sizeInBytes = convertToBytes(sizeText);
            const targetSize = convertToBytes(`${filters.size.value} ${filters.size.unit}`);
            
            switch (filters.size.operator) {
                case '=':
                    if (sizeInBytes !== targetSize) matches = false;
                    break;
                case '>':
                    if (sizeInBytes <= targetSize) matches = false;
                    break;
                case '<':
                    if (sizeInBytes >= targetSize) matches = false;
                    break;
                case '>=':
                    if (sizeInBytes < targetSize) matches = false;
                    break;
                case '<=':
                    if (sizeInBytes > targetSize) matches = false;
                    break;
            }
        }
        
        // Dimensions filter
        if (filters.dimensions && !row.cells[3].textContent.toLowerCase().includes(filters.dimensions)) {
            matches = false;
        }
        
        // Duration filter
        if (filters.duration && !row.cells[4].textContent.toLowerCase().includes(filters.duration)) {
            matches = false;
        }
        
        // Color Mode filter
        if (filters.colorMode && !row.cells[5].textContent.toLowerCase().includes(filters.colorMode)) {
            matches = false;
        }

        // Apply styling based on match status
        if (matches) {
            row.style.backgroundColor = '';
            row.style.color = 'var(--text-color)';
        } else {
            row.style.backgroundColor = 'rgba(255, 0, 0, 0.1)';
            row.style.color = '#ff0000';
        }
    });
}
// Update the file analyser initialization to include filters
function initializeFileAnalyser() {
    addFilterHeader();
    
    // Add event listeners for all filters
    document.querySelectorAll('.column-filter').forEach(filter => {
        filter.addEventListener('input', filterTable);
    });
    
    document.querySelector('.filter-operator').addEventListener('change', filterTable);
    document.querySelector('.size-value').addEventListener('input', filterTable);
    document.querySelector('.size-unit').addEventListener('change', filterTable);
}

function updateFilterOptions() {
    const rows = document.getElementById('fileAnalyserList').querySelectorAll('tr:not(.folder)');
    const formats = new Set();
    const colorModes = new Set();
    
    rows.forEach(row => {
        const format = row.cells[1].textContent;
        const colorMode = row.cells[5].textContent;
        
        if (format && format !== '-') formats.add(format);
        if (colorMode && colorMode !== '-') colorModes.add(colorMode);
    });
    
    // Update format dropdown
    const formatSelect = document.querySelector('[data-column="format"]');
    formatSelect.innerHTML = '<option value="">All formats</option>' + 
        Array.from(formats).sort().map(format => 
            `<option value="${format}">${format}</option>`).join('');
    
    // Update color mode dropdown
    const colorModeSelect = document.querySelector('[data-column="colorMode"]');
    colorModeSelect.innerHTML = '<option value="">All modes</option>' + 
        Array.from(colorModes).sort().map(mode => 
            `<option value="${mode}">${mode}</option>`).join('');
}

// Call initializeFileAnalyser after the table is created
// Add this line to your existing ZIP file processing code
document.getElementById('fileTable').style.display = 'table';
initializeFileAnalyser();


//Image analyser
document.addEventListener('DOMContentLoaded', function() {
    ['upload1', 'upload2'].forEach(id => {
        const uploadBox = document.getElementById(id);
        const fileInput = uploadBox.querySelector('.file-input');
        
          // Click handler for the upload box
          uploadBox.addEventListener('click', (e) => {
            // If click didn't originate from file input, trigger it
            if (e.target !== fileInput) {
                fileInput.click();
            }
        });

        uploadBox.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadBox.classList.add('dragover');
        });

        uploadBox.addEventListener('dragleave', () => {
            uploadBox.classList.remove('dragover');
        });

        uploadBox.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadBox.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].type.startsWith('image/')) {
                fileInput.files = files;
                fileInput.dispatchEvent(new Event('change'));
                
                // Show preview
                const reader = new FileReader();
                reader.onload = (event) => {
                    showPreview(uploadBox, event.target.result);
                };
                reader.readAsDataURL(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    showPreview(uploadBox, event.target.result);
                };
                reader.readAsDataURL(e.target.files[0]);
            }
        });
    });

    function showPreview(uploadBox, src) {
        let preview = uploadBox.querySelector('.upload-preview');
        if (!preview) {
            preview = document.createElement('img');
            preview.className = 'upload-preview';
            uploadBox.appendChild(preview);
        }
        preview.src = src;
        uploadBox.querySelector('.upload-content').style.display = 'none';
    }
});
let scale = 1;
        let isDragging = false;
        let currentMode = 'normal';
        let image1, image2;

        // File Upload Handling
        document.getElementById('file1').addEventListener('change', handleFileUpload);
        document.getElementById('file2').addEventListener('change', handleFileUpload);

        // Update the handleFileUpload function
        function handleFileUpload(e) {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = (event) => {
        const img = new Image();
        img.onload = () => {
            // Store visibility states before updating images
            const imageBeforeVisible = document.getElementById('imageBefore').style.visibility !== 'hidden';
            const imageAfterVisible = document.getElementById('imageAfter').style.visibility !== 'hidden';
            
            // Store eye icon states
            const eyeIcons = document.querySelectorAll('.eye-icon');
            const eyeStates = Array.from(eyeIcons).map(icon => icon.textContent);

            if (e.target.id === 'file1') {
                image1 = img;
                const imageBefore = document.getElementById('imageBefore');
                imageBefore.src = event.target.result;
                imageBefore.style.visibility = imageBeforeVisible ? 'visible' : 'hidden';
                eyeIcons[1].textContent = imageBeforeVisible ? '👁️' : '👁️‍🗨️';
                updateFileDetails(file, 'file1Details', img);
            } else {
                image2 = img;
                const imageAfter = document.getElementById('imageAfter');
                imageAfter.src = event.target.result;
                imageAfter.style.visibility = imageAfterVisible ? 'visible' : 'hidden';
                eyeIcons[0].textContent = imageAfterVisible ? '👁️' : '👁️‍🗨️';
                updateFileDetails(file, 'file2Details', img);
            }

            // Update layer names
            updateLayerNames();

            // Ensure eye icons match visibility states
            document.querySelectorAll('.eye-icon').forEach((icon, index) => {
                const image = document.getElementById(index === 0 ? 'imageAfter' : 'imageBefore');
                icon.textContent = image.style.visibility === 'hidden' ? '👁️‍🗨️' : '👁️';
            });

            validateAndInit();
        };
        img.src = event.target.result;
    };
    reader.readAsDataURL(file);
}

        function validateAndInit() {
            const errorDiv = document.getElementById('error');
            if (!image1 || !image2) return;

            if (image1.width !== image2.width || image1.height !== image2.height) {
                showError('Error: Images must have the same dimensions');
                return;
            }
            
            errorDiv.classList.add('hidden');
            initComparison();
            setupLayerControls();
            updateLayerNames(); // Add this line
        }

        // Update the image loading to ensure proper sizing
        function initComparison() {
            const imageBefore = document.getElementById('imageBefore');
            const imageAfter = document.getElementById('imageAfter');
            const viewer = document.querySelector('.image-viewer');
            
            // Set initial image sources
            imageBefore.src = image1.src;
            imageAfter.src = image2.src;
            
            // Wait for both images to load
            Promise.all([
                new Promise(resolve => imageBefore.onload = resolve),
                new Promise(resolve => imageAfter.onload = resolve)
            ]).then(() => {
                // Reset zoom and position
                resetZoom();
                viewer.scrollTo(0, 0);
                applyBlendMode(currentMode);
            });
        }

        // Blend Modes
        document.querySelectorAll('.blend-modes button').forEach(button => {
            button.addEventListener('click', () => {
                currentMode = button.dataset.mode;
                applyBlendMode(currentMode);
            });
        });

        function applyBlendMode(mode) {
            const imageAfter = document.getElementById('imageAfter');
            imageAfter.style.mixBlendMode = mode;
        }

        // Layer Controls
        function setupLayerControls() {
    const eyeIcons = document.querySelectorAll('.eye-icon');
    const opacitySliders = document.querySelectorAll('.opacity-slider');
    const blendModeSelects = document.querySelectorAll('.blend-mode-select');

    eyeIcons.forEach((icon, index) => {
        const image = document.getElementById(index === 0 ? 'imageAfter' : 'imageBefore');
        
        // Initialize icon state based on current image visibility
        if (image) {
            icon.textContent = image.style.visibility === 'hidden' ? '👁️‍🗨️' : '👁️';
        }

        icon.addEventListener('click', () => {
            const image = document.getElementById(index === 0 ? 'imageAfter' : 'imageBefore');
            if (!image) return;

            const newVisibility = icon.textContent === '👁️' ? 'hidden' : 'visible';
            image.style.visibility = newVisibility;
            icon.textContent = newVisibility === 'hidden' ? '👁️‍🗨️' : '👁️';
        });
    });

    opacitySliders.forEach((slider, index) => {
        slider.addEventListener('input', () => {
            const image = document.getElementById(index === 0 ? 'imageAfter' : 'imageBefore');
            image.style.opacity = slider.value / 100;
        });
    });

    blendModeSelects.forEach((select, index) => {
        select.addEventListener('change', () => {
            const image = document.getElementById(index === 0 ? 'imageAfter' : 'imageBefore');
            image.style.mixBlendMode = select.value;
        });
    });
}

        // Zoom Controls
        document.getElementById('zoomIn').addEventListener('click', () => {
            const viewer = document.querySelector('.image-viewer');
            const rect = viewer.getBoundingClientRect();
            adjustZoom(0.1, rect.left + rect.width / 2, rect.top + rect.height / 2);
        });
        document.getElementById('zoomOut').addEventListener('click', () => {
            const viewer = document.querySelector('.image-viewer');
            const rect = viewer.getBoundingClientRect();
            adjustZoom(-0.1, rect.left + rect.width / 2, rect.top + rect.height / 2);
        });
        document.getElementById('resetZoom').addEventListener('click', resetZoom);

        // Replace the zoom control functions
        // Update the adjustZoom function
        function adjustZoom(amount, mouseX = null, mouseY = null) {
    const container = document.querySelector('.image-container');
    const viewer = document.querySelector('.image-viewer');
    const viewerRect = viewer.getBoundingClientRect();
    const imageBefore = document.getElementById('imageBefore');
    const imageAfter = document.getElementById('imageAfter');
    
    // Calculate new scale
    const newScale = Math.min(5, Math.max(0.1, scale + amount));
    
    // Get mouse position relative to viewer
    const relativeX = mouseX !== null ? mouseX - viewerRect.left : viewerRect.width / 2;
    const relativeY = mouseY !== null ? mouseY - viewerRect.top : viewerRect.height / 2;
    
    // Calculate point on content at mouse position
    const contentX = (viewer.scrollLeft + relativeX) / scale;
    const contentY = (viewer.scrollTop + relativeY) / scale;
    
    // Update scale
    scale = newScale;
    
    // Apply scale to images instead of container
    [imageBefore, imageAfter].forEach(img => {
        if (img) {
            img.style.transform = `scale(${scale})`;
            img.style.transformOrigin = '0 0';
        }
    });
    
    // Keep container size fixed
    container.style.width = '100%';
    container.style.height = '100%';
    
    // Calculate new scroll position to keep mouse point fixed
    viewer.scrollLeft = contentX * scale - relativeX;
    viewer.scrollTop = contentY * scale - relativeY;
    
    // Update overflow
    viewer.style.overflow = scale > 1 ? 'auto' : 'hidden';
}

// Update the resetZoom function
function resetZoom() {
    const container = document.querySelector('.image-container');
    const viewer = document.querySelector('.image-viewer');
    const imageBefore = document.getElementById('imageBefore');
    const imageAfter = document.getElementById('imageAfter');
    
    scale = 1;
    
    // Reset image transforms
    [imageBefore, imageAfter].forEach(img => {
        if (img) {
            img.style.transform = 'scale(1)';
            img.style.transformOrigin = '0 0';
        }
    });
    
    // Reset container size
    container.style.width = '100%';
    container.style.height = '100%';
    
    // Reset scroll position
    viewer.scrollTo(0, 0);
    viewer.style.overflow = 'hidden';
}

        // Layer Swapping
        document.getElementById('swapLayers').addEventListener('click', () => {
    // Store current visibility states
    const imageBeforeVisible = document.getElementById('imageBefore').style.visibility !== 'hidden';
    const imageAfterVisible = document.getElementById('imageAfter').style.visibility !== 'hidden';
    
    // Swap only the images
    [image1, image2] = [image2, image1];
    document.getElementById('imageBefore').src = image1.src;
    document.getElementById('imageAfter').src = image2.src;
    
    // Restore visibility states
    document.getElementById('imageBefore').style.visibility = imageBeforeVisible ? 'visible' : 'hidden';
    document.getElementById('imageAfter').style.visibility = imageAfterVisible ? 'visible' : 'hidden';
    
    // Reset all effects to normal
    const blendModeSelects = document.querySelectorAll('.blend-mode-select');
    const opacitySliders = document.querySelectorAll('.opacity-slider');
    
    // Reset blend modes to normal
    blendModeSelects.forEach(select => {
        select.value = 'normal';
    });
    
    // Reset opacity to 100%
    opacitySliders.forEach(slider => {
        slider.value = 100;
    });
    
    // Reset blend mode buttons
    document.querySelectorAll('.blend-modes button').forEach(button => {
        button.classList.remove('active');
        if (button.dataset.mode === 'normal') {
            button.classList.add('active');
        }
    });
    
    // Reset current mode
    currentMode = 'normal';
    
    // Apply normal blend mode to both images
    const imageBefore = document.getElementById('imageBefore');
    const imageAfter = document.getElementById('imageAfter');
    imageBefore.style.mixBlendMode = 'normal';
    imageAfter.style.mixBlendMode = 'normal';
    imageBefore.style.opacity = 1;
    imageAfter.style.opacity = 1;
});

        // Add this new function to update layer names
        // Update the updateLayerNames function
        function updateLayerNames() {
            const layerNames = document.querySelectorAll('.layer-header span:not(.eye-icon)');
            // Get file names from the file inputs
            const file1Name = document.getElementById('file1').files[0]?.name || 'Layer 1';
            const file2Name = document.getElementById('file2').files[0]?.name || 'Layer 2';
            
            // Invert the order - image2 for top layer, image1 for bottom layer
            layerNames[0].textContent = file2Name;
            layerNames[1].textContent = file1Name;
        }

        // File Details
        // Update the updateFileDetails function
        function updateFileDetails(file, elementId, dimensions) {
    const details = document.getElementById(elementId);
    if (!file) {
        details.innerHTML = '<p>No file selected</p>';
        return;
    }

    // Format file size
    let fileSize = 'N/A';
    if (file.size) {
        fileSize = file.size < 1024 * 1024 
            ? `${(file.size / 1024).toFixed(2)} KB` 
            : `${(file.size / (1024 * 1024)).toFixed(2)} MB`;
    }

    // Format date
    let lastModified = 'N/A';
    if (file.lastModified) {
        try {
            lastModified = new Date(file.lastModified).toLocaleString();
        } catch (e) {
            console.error('Error formatting date:', e);
        }
    }

    details.innerHTML = `
        <p><strong>File Name:</strong> ${file.name || 'N/A'}</p>
        <p><strong>Size:</strong> ${fileSize}</p>
        <p><strong>Dimensions:</strong> ${dimensions.naturalWidth || 0}x${dimensions.naturalHeight || 0}</p>
        <p><strong>Type:</strong> ${file.type || 'N/A'}</p>
        <p><strong>Last Modified:</strong> ${lastModified}</p>
    `;
}

function updateLayerNames() {
    const layerNames = document.querySelectorAll('.layer-header span:not(.eye-icon)');
    // Get file names from the file inputs
    const file1Name = document.getElementById('file1').files[0]?.name || 'Layer 1';
    const file2Name = document.getElementById('file2').files[0]?.name || 'Layer 2';
    
    // Update both the text content and title attribute for tooltips
    layerNames.forEach((span, index) => {
        const name = index === 0 ? file2Name : file1Name;
        span.textContent = name;
        span.setAttribute('title', name);
    });
}

        // New Check
        document.getElementById('newCheck').addEventListener('click', () => {
    // Reset file inputs and clear upload previews
    ['upload1', 'upload2'].forEach(id => {
        const uploadBox = document.getElementById(id);
        const fileInput = uploadBox.querySelector('.file-input');
        fileInput.value = '';
        
        // Remove preview images if they exist
        const preview = uploadBox.querySelector('.upload-preview');
        if (preview) preview.remove();
        
        // Show upload content again
        uploadBox.querySelector('.upload-content').style.display = 'block';
    });

    // Clear images from viewer
    const imageBefore = document.getElementById('imageBefore');
    const imageAfter = document.getElementById('imageAfter');
    const differenceCanvas = document.getElementById('differenceCanvas');
    
    // Clear and reset canvas
    if (differenceCanvas) {
        const ctx = differenceCanvas.getContext('2d');
        ctx.clearRect(0, 0, differenceCanvas.width, differenceCanvas.height);
        differenceCanvas.width = 0;
        differenceCanvas.height = 0;
        differenceCanvas.classList.add('hidden');
    }

    // Reset the image container to initial state
    const imageContainer = document.querySelector('.image-container');
    imageContainer.style.border = '2px dashed var(--border-color)';
    imageContainer.style.background = 'var(--tool-bg)';
    imageContainer.style.transform = 'scale(1)';
    imageContainer.style.width = '100%';
    imageContainer.style.height = '100%';
    imageContainer.style.cssText = `
        position: relative;
        width: 100%;
        height: 100%;
        transform-origin: 0 0;
        min-height: 400px;
        border: 2px dashed var(--border-color);
        border-radius: 8px;
        background: var(--tool-bg);
        transform: scale(1);
    `;

    // Reset image container content
    imageContainer.innerHTML = `
        <img id="imageBefore" class="image">
        <img id="imageAfter" class="image">
        <canvas id="differenceCanvas" class="hidden"></canvas>
    `;
    // Reset layer names to default
    const layerNames = document.querySelectorAll('.layer-header span:not(.eye-icon)');
    layerNames[0].textContent = 'Layer 2';
    layerNames[1].textContent = 'Layer 1';
    // Reset file details
    document.getElementById('file1Details').innerHTML = '<p>No file selected</p>';
    document.getElementById('file2Details').innerHTML = '<p>No file selected</p>';
    
    
    // Reset blend modes
    document.querySelectorAll('.blend-mode-select').forEach(select => {
        select.value = 'normal';
    });
    
    // Reset opacity sliders
    document.querySelectorAll('.opacity-slider').forEach(slider => {
        slider.value = 100;
    });
    
    // Reset eye icons and image visibility
    document.querySelectorAll('.eye-icon').forEach((icon, index) => {
        icon.textContent = '👁️';
        const image = document.getElementById(index === 0 ? 'imageAfter' : 'imageBefore');
        if (image) {
            image.style.visibility = 'visible';
        }
    });
    
    // Reset blend mode buttons
    document.querySelectorAll('.blend-modes button').forEach(button => {
        button.classList.remove('active');
        if (button.dataset.mode === 'normal') {
            button.classList.add('active');
        }
    });
    
    // Reset image properties
    [imageBefore, imageAfter].forEach(img => {
        if (img) {
            img.style.mixBlendMode = 'normal';
            img.style.opacity = 1;
            img.style.display = 'block';
            img.style.visibility = 'visible'; // Add this line
        }
    });
    
    // Reset zoom and scale
    scale = 1;
    resetZoom();
    
    // Clear any errors
    const errorDiv = document.getElementById('error');
    errorDiv.textContent = '';
    errorDiv.classList.add('hidden');
    
    // Reset variables
    image1 = null;
    image2 = null;
    currentMode = 'normal';
    isDragging = false;
    
    // Reset current mode
    currentMode = 'normal';

    // Re-initialize layer controls
    setupLayerControls();
});
        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
        }
        
        // Update the panning function
        function setupPanning() {
            const viewer = document.querySelector('.image-viewer');
            let isPanning = false;
            let startX, startY;

            viewer.addEventListener('mousedown', (e) => {
                if (scale <= 1) return;
                isPanning = true;
                viewer.style.cursor = 'grabbing';
                startX = e.pageX - viewer.offsetLeft;
                startY = e.pageY - viewer.offsetTop;
            });

            viewer.addEventListener('mouseleave', () => {
                isPanning = false;
                viewer.style.cursor = 'default';
            });

            viewer.addEventListener('mouseup', () => {
                isPanning = false;
                viewer.style.cursor = 'default';
            });

            viewer.addEventListener('mousemove', (e) => {
                if (!isPanning) return;
                e.preventDefault();
                const x = e.pageX - viewer.offsetLeft;
                const y = e.pageY - viewer.offsetTop;
                viewer.scrollBy(startX - x, startY - y);
                startX = x;
                startY = y;
            });

            // Add mouse wheel zoom support
            viewer.addEventListener('wheel', handleWheelZoom, { passive: false });
        }

        // Add smooth zoom for mouse wheel
        function handleWheelZoom(e) {
            if (e.ctrlKey) {
                e.preventDefault();
                const delta = e.deltaY > 0 ? -0.1 : 0.1;
                adjustZoom(delta, e.clientX, e.clientY);
            }
        }

        // Call setupPanning after DOM loads
        document.addEventListener('DOMContentLoaded', () => {
            const viewer = document.querySelector('.image-viewer');
            viewer.addEventListener('wheel', handleWheelZoom, { passive: false });
            setupPanning();
        });










// Notes
const sampleProducts = [
    {
      "id": 1748505763395,
      "name": "APP Banner",
      "dimensions": "1200x400",
      "fileSizeLimit": "200KB",
      "format": "JPG",
      "bitRate": "-",
      "duration": "-",
      "fps": "-",
      "description": "",
      "folderPath": "Weekly Trade - OwnChannel"
    },
    {
      "id": 1748505797837,
      "name": "Carousel Akcniceny.cz",
      "dimensions": "1080x1080",
      "fileSizeLimit": "200KB",
      "format": "JPG",
      "bitRate": "-",
      "duration": "-",
      "fps": "-",
      "description": "",
      "folderPath": "Weekly Trade - OwnChannel"
    },
    {
      "id": 1748507164225,
      "name": "Profil řetězec",
      "dimensions": "1000x340, 320x252",
      "fileSizeLimit": "400KB",
      "format": "JPG,PNG",
      "bitRate": "-",
      "duration": "-",
      "fps": "-",
      "description": "",
      "folderPath": "Weekly Trade - OwnChannel"
    },
    {
      "id": 1748510713739,
      "name": "Top Wallpapaer",
      "dimensions": "1000x340, 320x252",
      "fileSizeLimit": "400KB",
      "format": "JPG",
      "bitRate": "-",
      "duration": "-",
      "fps": "-",
      "description": "",
      "folderPath": "Weekly Trade - OwnChannel"
    }
];

// DOM Elements
const productsContainer = document.getElementById('productsContainer');
const editToggle = document.getElementById('editToggle');
const editToggle2 = document.getElementById('editToggle2');
const modalOverlay = document.getElementById('modalOverlay');
const formTitle = document.getElementById('formTitle');
const cancelEdit = document.getElementById('cancelEdit');
const saveProduct = document.getElementById('saveProduct');
const newProductBtn = document.getElementById('newProductBtn');
const newProductBtn2 = document.getElementById('newProductBtn2');
const importBtn = document.getElementById('importBtn');
const importBtn2 = document.getElementById('importBtn2');
const exportBtn = document.getElementById('exportBtn');
const exportBtn2 = document.getElementById('exportBtn2');
const productSearch = document.getElementById('productSearch');
const closeModal = document.getElementById('closeModal');
const noProductsState = document.getElementById('noProductsState');
const folderCount = document.getElementById('folderCount');
const totalProducts = document.getElementById('totalProducts');
const storageUsed = document.getElementById('storageUsed');
const searchMatches = document.getElementById('searchMatches');
const addFromEmptyBtn = document.getElementById('addFromEmptyBtn');

// State
let products = [];
let folders = [];
let isEditMode = false;
let currentEditId = null;
let expandedFolders = new Set();
let matchCount = 0;
let foldersToExpandForSearch = new Set();
let editModeClickCount = 0;
let editModeLastClickTime = 0;

// First, add these constants at the beginning of your Notes code
const ACTIVATION_CODE = 'catalyst2025';
let isNotesActivated = false;

// Initialize the app
function initApp() {
    // Load products from localStorage or use sample data
    const storedProducts = localStorage.getItem('productNotes');
    products = storedProducts ? JSON.parse(storedProducts) : sampleProducts;
    
    // Ensure products is always an array
    if (!Array.isArray(products)) {
        products = sampleProducts;
    }
    document.getElementById('newProductBtn').style.display = 'none';
    // Build folder structure
    buildFolderStructure();
    
    // Initialize stats container as collapsed
    const statsContainer = document.getElementById('statsContainer');
    const statsToggle = document.querySelector('.stats-toggle');
    
    statsContainer.style.display = 'none';
    statsContainer.classList.remove('visible');
    statsToggle.classList.add('collapsed');
    
// Show no products state if there are no products
    if (products.length === 0) {
        document.getElementById('noProductsState').style.display = 'flex';
    } else {
        document.getElementById('noProductsState').style.display = 'none';
    }

    // Render products and update stats
    renderProducts();
    updateStats();
    setupEventListeners();

    // Initially hide admin elements
    activateAdminMode(false);
}

// Toggle stats visibility
function toggleStats(button) {
    const statsContainer = document.getElementById('statsContainer');
    const isCollapsed = button.classList.contains('collapsed');
    
    // Toggle button class
    button.classList.toggle('collapsed');
    
    // Update arrow rotation and container visibility
    if (isCollapsed) {
        statsContainer.style.display = 'grid';
        setTimeout(() => statsContainer.classList.add('visible'), 0);
    } else {
        statsContainer.classList.remove('visible');
        setTimeout(() => statsContainer.style.display = 'none', 300); // Match transition duration
    }
}

// Build folder structure from product folder paths
function buildFolderStructure() {
    folders = [];
    const folderSet = new Set();
    
    products.forEach(product => {
        // Skip products with blank or empty folder paths
        if (!product.folderPath || product.folderPath.trim() === '') return;
        
        const pathParts = product.folderPath.split('/');
        let currentPath = '';
        
        pathParts.forEach((part, index) => {
            currentPath = currentPath ? `${currentPath}/${part}` : part;
            
            if (!folderSet.has(currentPath)) {
                folderSet.add(currentPath);
                folders.push({
                    id: `folder-${currentPath}`,
                    name: part,
                    path: currentPath,
                    level: index,
                    parent: index > 0 ? pathParts.slice(0, index).join('/') : null
                });
            }
        });
    });
}

// Highlight search term in text
function highlightSearchTerm(text, searchTerm) {
    if (!searchTerm || !text) return text;
    
    const regex = new RegExp(`(${searchTerm})`, 'gi');
    return text.replace(regex, '<span class="highlight">$1</span>');
}

// Determine if a product matches the search term
function isProductMatch(product, searchTerm) {
    return (
        (product.name && product.name.toLowerCase().includes(searchTerm)) ||
        (product.dimensions && product.dimensions.toLowerCase().includes(searchTerm)) ||
        (product.format && product.format.toLowerCase().includes(searchTerm)) ||
        (product.description && product.description.toLowerCase().includes(searchTerm)) ||
        (product.folderPath && product.folderPath.toLowerCase().includes(searchTerm))
    );
}

// Determine if a folder matches the search term
function isFolderMatch(folder, searchTerm) {
    return (
        (folder.name && folder.name.toLowerCase().includes(searchTerm)) ||
        (folder.path && folder.path.toLowerCase().includes(searchTerm))
    );
}

// Calculate folders to expand for search results
function calculateFoldersToExpand(searchTerm) {
    const foldersToExpand = new Set();
    
    if (!searchTerm) return foldersToExpand;
    
    // Check products and their folders
    products.forEach(product => {
        if (isProductMatch(product, searchTerm)) {
            // Add all parent folders of this product
            let currentPath = product.folderPath || '';
            while (currentPath) {
                foldersToExpand.add(currentPath);
                const parts = currentPath.split('/');
                parts.pop();
                currentPath = parts.join('/');
            }
        }
    });
    
    // Check folders themselves
    folders.forEach(folder => {
        if (isFolderMatch(folder, searchTerm)) {
            // Add this folder and all its parents
            let currentPath = folder.path;
            while (currentPath) {
                foldersToExpand.add(currentPath);
                const parts = currentPath.split('/');
                parts.pop();
                currentPath = parts.join('/');
            }
        }
    });
    
    return foldersToExpand;
}

// Render products to the UI in table format with folder hierarchy
function renderProducts() {
    productsContainer.innerHTML = '';
    
    const searchTerm = productSearch.value.toLowerCase();
    matchCount = 0;
    
    // Calculate folders to expand for search
    foldersToExpandForSearch = calculateFoldersToExpand(searchTerm);
    
    // Group products by folder
    const productsByFolder = {};
    
    // Add all folders
    folders.forEach(folder => {
        productsByFolder[folder.path] = {
            folder: folder,
            products: []
        };
    });
    
    // Assign products to folders
    products.forEach(product => {
        const folderPath = product.folderPath || '';
        
        // Handle blank folder paths (show at root level)
        if (!folderPath || folderPath.trim() === '') {
            if (!productsByFolder['']) {
                productsByFolder[''] = {
                    folder: null,
                    products: []
                };
            }
            productsByFolder[''].products.push(product);
        } else {
            if (productsByFolder[folderPath]) {
                productsByFolder[folderPath].products.push(product);
            } else {
                // Create the folder if it doesn't exist
                const pathParts = folderPath.split('/');
                let currentPath = '';
                
                pathParts.forEach((part, index) => {
                    currentPath = currentPath ? `${currentPath}/${part}` : part;
                    
                    if (!productsByFolder[currentPath]) {
                        productsByFolder[currentPath] = {
                            folder: {
                                id: `folder-${currentPath}`,
                                name: part,
                                path: currentPath,
                                level: index,
                                parent: index > 0 ? pathParts.slice(0, index).join('/') : null
                            },
                            products: []
                        };
                    }
                });
                
                if (productsByFolder[folderPath]) {
                    productsByFolder[folderPath].products.push(product);
                }
            }
        }
    });
    
    // Render folder hierarchy
    let totalRendered = 0;
    const renderedFolders = new Set();
    
    // Function to render a folder and its contents
    const renderFolderRecursive = (folderPath, level) => {
        const folderData = productsByFolder[folderPath];
        if (!folderData || renderedFolders.has(folderPath)) return 0;
        
        renderedFolders.add(folderPath);
        const isExpanded = expandedFolders.has(folderPath) || foldersToExpandForSearch.has(folderPath);
        let renderedCount = 0;
        
        // Check if folder matches search
        const folderMatches = searchTerm && isFolderMatch(folderData.folder, searchTerm);
        
        if (folderMatches) matchCount++;
        
        // Render folder row
        const folder = folderData.folder;
        
        // Determine icon color based on folder level
        let iconClass = "folder-icon-top"; // Top-level folders
        if (level === 1) {
            iconClass = "folder-icon-sub"; // First-level subfolders
        } else if (level >= 2) {
            iconClass = "folder-icon-deep"; // Deeper levels
        }
        
        const folderRow = document.createElement('tr');
        folderRow.className = `folder-row ${isExpanded ? 'expanded' : ''} ${folderMatches ? 'match-highlight' : ''}`;
        folderRow.dataset.folderId = folder.id;
        
        // Highlight search term in folder name
        const displayName = highlightSearchTerm(folder.name, searchTerm);
        
        folderRow.innerHTML = `
            <td colspan="8" style="position: relative;">
                <div class="folder-hierarchy" style="width: ${level * 20}px"></div>
                <span class="folder-toggle">${isExpanded ? '▼' : '▶'}</span>
                <i class="fas fa-folder folder-icon ${iconClass}"></i>
                <span class="folder-name">${displayName}</span>
            </td>
        `;
        productsContainer.appendChild(folderRow);
        
        // Add event listener for folder toggle
        folderRow.querySelector('.folder-toggle').addEventListener('click', () => {
            toggleFolder(folder.path);
        });
        
        // Add event listener for folder deletion in edit mode
        if (isEditMode) {
            const deleteBtn = document.createElement('div');
            deleteBtn.className = 'action-btn mini delete-folder-btn';
            deleteBtn.title = 'Delete Folder';
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
            deleteBtn.style.position = 'absolute';
            deleteBtn.style.right = '15px';
            deleteBtn.style.top = '50%';
            deleteBtn.style.transform = 'translateY(-50%)';
            deleteBtn.addEventListener('click', () => {
                deleteFolder(folder.path);
            });
            folderRow.querySelector('td').appendChild(deleteBtn);
        }
        
        // Render products in this folder
        if (isExpanded) {
            folderData.products.forEach(product => {
                // Check if product matches search
                const productMatches = searchTerm && isProductMatch(product, searchTerm);
                
                if (productMatches) matchCount++;
                
                renderProduct(product, level + 1, productMatches);
                renderedCount++;
                totalRendered++;
            });
            
            // Render subfolders
            Object.keys(productsByFolder).forEach(otherPath => {
                const otherFolder = productsByFolder[otherPath].folder;
                if (otherFolder && otherFolder.parent === folder.path) {
                    renderedCount += renderFolderRecursive(otherPath, level + 1);
                }
            });
        }
        
        return renderedCount;
    };
    
    // Top-level folders
    Object.keys(productsByFolder).forEach(folderPath => {
        const folderData = productsByFolder[folderPath];
        if (folderData.folder && !folderData.folder.parent) {
            renderFolderRecursive(folderPath, 0);
        }
    });
    
    // Products not in any folder (blank folder paths)
    if (productsByFolder[''] && productsByFolder[''].products.length > 0) {
        productsByFolder[''].products.forEach(product => {
            const productMatches = searchTerm && isProductMatch(product, searchTerm);
            
            if (productMatches) matchCount++;
            
            renderProduct(product, 0, productMatches);
            totalRendered++;
        });
    }
    
    // Show no results state only when no folders or products are visible
    if (totalRendered === 0 && folders.length === 0 && !searchTerm) {
        noProductsState.style.display = 'flex';
    } else {
        noProductsState.style.display = 'none';
    }
    
    // Update search matches count
    searchMatches.textContent = matchCount;

    // When creating table rows, modify the actions column visibility
    const actionHeader = document.querySelector('#productsTable th:last-child');
    if (actionHeader) {
        actionHeader.style.display = isNotesActivated ? '' : 'none';
    }
}

// Render a product row

function renderProduct(product, level, isMatch) {
    const searchTerm = productSearch.value.toLowerCase();
    const productRow = document.createElement('tr');
    productRow.className = `product-row ${isMatch ? 'match-highlight' : ''}`;
    productRow.dataset.id = product.id;
    
    // Highlight search term in product name
    const displayName = highlightSearchTerm(product.name, searchTerm);
    
    productRow.innerHTML = `
        <td style="position: relative; padding-left: ${20 + (level * 20)}px">
            <div class="folder-indent" style="width: ${level * 20}px"></div>
            <i class="fas fa-file-alt"; margin-right: 8px;" style="padding-right: 10px;"></i>
            ${displayName}
        </td>
        <td>${highlightSearchTerm(product.dimensions || 'N/A', searchTerm)}</td>
        <td>${highlightSearchTerm(product.fileSizeLimit, searchTerm)}</td>
        <td>${highlightSearchTerm(product.format, searchTerm)}</td>
        <td>${highlightSearchTerm(product.bitRate, searchTerm)}</td>
        <td>${highlightSearchTerm(product.duration, searchTerm)}</td>
        <td>${highlightSearchTerm(product.fps || 'N/A', searchTerm)}</td>
        <td class="description-column">${highlightSearchTerm(product.description || '-', searchTerm)}</td>
        <td class="actions-column">
            <div class="product-actions">
                <div class="action-btn mini edit-btn" title="Edit">
                    <i class="fas fa-edit"></i>
                </div>
                ${isEditMode ? `
                    <div class="action-btn mini delete-btn" title="Delete">
                        <i class="fas fa-trash"></i>
                    </div>
                ` : ''}
            </div>
        </td>
    `;
    productsContainer.appendChild(productRow);
    
    // Add event listeners to action buttons
    productRow.querySelector('.edit-btn').addEventListener('click', () => {
        openEditForm(product.id);
    });
    
    if (isEditMode) {
        productRow.querySelector('.delete-btn').addEventListener('click', () => {
            deleteProduct(product.id);
        });
    }

    // Update visibility based on edit mode
    const descriptionColumn = productRow.querySelector('.description-column');
    const actionsColumn = productRow.querySelector('.actions-column');
    
    descriptionColumn.style.display = '';
    actionsColumn.style.display = isNotesActivated ? '' : 'none';
}

// Update statistics
function updateStats() {
    folderCount.textContent = folders.length;
    totalProducts.textContent = products.length;
    
    // Calculate storage used
    const dataStr = JSON.stringify(products);
    const sizeInKB = (dataStr.length / 1024).toFixed(2);
    storageUsed.textContent = `${sizeInKB} KB`;
}

// Toggle folder expansion
function toggleFolder(folderPath) {
    if (expandedFolders.has(folderPath)) {
        expandedFolders.delete(folderPath);
    } else {
        expandedFolders.add(folderPath);
    }
    renderProducts();
    updateStats();
}

// Open the edit form with product data
function openEditForm(productId) {
    const product = products.find(p => p.id === productId);
    currentEditId = productId;
    
    if (product) {
        formTitle.textContent = "Edit Product";
        // Fill form with product data
        document.getElementById('productName').value = product.name;
        document.getElementById('dimensions').value = product.dimensions || '';
        document.getElementById('fileSize').value = product.fileSizeLimit;
        document.getElementById('format').value = product.format;
        document.getElementById('bitrate').value = product.bitRate;
        document.getElementById('duration').value = product.duration;
        document.getElementById('fps').value = product.fps || '';
        document.getElementById('description').value = product.description || '';
        document.getElementById('folderPath').value = product.folderPath || '';
    } else {
        formTitle.textContent = "New Product";
        // Reset form
        document.getElementById('productName').value = "";
        document.getElementById('dimensions').value = "";
        document.getElementById('fileSize').value = "";
        document.getElementById('format').value = "";
        document.getElementById('bitrate').value = "";
        document.getElementById('duration').value = "";
        document.getElementById('fps').value = "";
        document.getElementById('description').value = "";
        document.getElementById('folderPath').value = "";
    }
    
    // Show the modal
    modalOverlay.style.display = 'flex';
}

// Close the edit form
function closeEditForm() {
    modalOverlay.style.display = 'none';
    currentEditId = null;
}

// Save product changes
function saveProductChanges() {
    if (currentEditId) {
        // Update existing product
        const productIndex = products.findIndex(p => p.id === currentEditId);
        if (productIndex === -1) return;
        
        const folderPath = document.getElementById('folderPath').value;
        
        products[productIndex] = {
            ...products[productIndex],
            name: document.getElementById('productName').value,
            dimensions: document.getElementById('dimensions').value,
            fileSizeLimit: document.getElementById('fileSize').value,
            format: document.getElementById('format').value,
            bitRate: document.getElementById('bitrate').value,
            duration: document.getElementById('duration').value,
            fps: document.getElementById('fps').value,
            description: document.getElementById('description').value,
            folderPath: folderPath
        };
    } else {
        // Create new product
        const folderPath = document.getElementById('folderPath').value;
        
        const newProduct = {
            id: Date.now(), // Simple unique ID
            name: document.getElementById('productName').value,
            dimensions: document.getElementById('dimensions').value,
            fileSizeLimit: document.getElementById('fileSize').value,
            format: document.getElementById('format').value,
            bitRate: document.getElementById('bitrate').value,
            duration: document.getElementById('duration').value,
            fps: document.getElementById('fps').value,
            description: document.getElementById('description').value,
            folderPath: folderPath
        };
        
        products.push(newProduct);
    }
    
    // Save to localStorage
    localStorage.setItem('productNotes', JSON.stringify(products));
    
    // Rebuild folder structure
    buildFolderStructure();
    
    // Refresh UI
    renderProducts();
    updateStats();
    closeEditForm();
}

// Delete a product
function deleteProduct(productId) {
    if (confirm("Are you sure you want to delete this product?")) {
        products = products.filter(p => p.id !== productId);
        localStorage.setItem('productNotes', JSON.stringify(products));
        
        // Rebuild folder structure
        buildFolderStructure();
        
        renderProducts();
        updateStats();
    }
}

// Delete a folder and its contents
function deleteFolder(folderPath) {
    if (confirm("Are you sure you want to delete this folder and all its contents?")) {
        // Delete all products in this folder and its subfolders
        products = products.filter(product => 
            !product.folderPath || !product.folderPath.startsWith(folderPath)
        );
        
        // Save changes
        localStorage.setItem('productNotes', JSON.stringify(products));
        
        // Rebuild folder structure
        buildFolderStructure();
        
        // Remove folder from expanded set
        expandedFolders.delete(folderPath);
        
        renderProducts();
        updateStats();
    }
}

// Toggle edit mode
function toggleEditMode() {
    const currentTime = new Date().getTime();
    
    // Reset counter if more than 2 seconds between clicks
    if (currentTime - editModeLastClickTime > 1000) {
        editModeClickCount = 0;
    }
    
    editModeClickCount++;
    editModeLastClickTime = currentTime;

    // Check for 5 rapid clicks
    if (editModeClickCount === 5) {
        if (confirm("🗑️ You found a secret! Do you want to delete all products and start fresh?")) {
            // Clear all products
            products = [];
            localStorage.setItem('productNotes', JSON.stringify(products));
            
            // Clear folder structure
            folders = [];
            expandedFolders.clear();
            
            // Reset stats
            matchCount = 0;
            currentEditId = null;
            
            // Update UI
            renderProducts();
            updateStats();
            
            // Show empty state
            document.getElementById('noProductsState').style.display = 'flex';
            // Update column visibility
    const descriptionColumns = document.querySelectorAll('.description-column');
    const descriptionHeader = document.querySelector('th.description-column');
    
    descriptionColumns.forEach(col => {
        col.style.display = isEditMode ? 'none' : '';
    });
    
    if (descriptionHeader) {
        descriptionHeader.style.display = isEditMode ? 'none' : '';
    }
            // Show confirmation message
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--primary-color);
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                z-index: 1000;
                animation: slideDown 0.3s ease-out;
            `;
            message.textContent = "All products have been cleared! 🧹";
            document.body.appendChild(message);
            
            // Remove message after 3 seconds
            setTimeout(() => {
                message.style.animation = 'slideUp 0.3s ease-out';
                setTimeout(() => message.remove(), 300);
            }, 3000);
        }
        editModeClickCount = 0;
        return;
    }

    // Regular edit mode toggle functionality
    isEditMode = !isEditMode;
    const editBtn = document.getElementById('editToggle');
    
    if (isEditMode) {
        editBtn.innerHTML = `<i class="fas fa-times" style="color: #ff0000;"></i> Exit Edit`;
        editBtn.style.color = '#ff0000';
        editBtn.style.borderColor = '#ff0000';
        editBtn.style.background = 'transparent';
        editBtn.style.border = '2px solid #ff0000';
    } else {
        editBtn.innerHTML = `<i class="fas fa-edit"></i> Edit Mode`;
        editBtn.style.color = '';
        editBtn.style.borderColor = '';
        editBtn.style.background = '';
        editBtn.style.border = '';
    }
    // Show/hide Add Product button based on edit mode
    newProductBtn.style.display = isEditMode ? 'inline-flex' : 'none';

    renderProducts();
}

// Export data
function exportData() {
    const data = {
        products: products
    };
    
    const dataStr = JSON.stringify(data, null, 2);
    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
    
    const exportFileDefaultName = 'product-notes.json';
    
    const linkElement = document.createElement('a');
    linkElement.setAttribute('href', dataUri);
    linkElement.setAttribute('download', exportFileDefaultName);
    document.body.appendChild(linkElement);
    linkElement.click();
    document.body.removeChild(linkElement);
}

// Import data

function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    
    input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        
        reader.onload = event => {
            try {
                const importedData = JSON.parse(event.target.result);
                
                if (importedData.products && Array.isArray(importedData.products)) {
                    // Generate new unique IDs for imported products
                    const maxCurrentId = Math.max(...products.map(p => p.id), 0);
                    const newProducts = importedData.products.map((product, index) => ({
                        ...product,
                        id: maxCurrentId + index + 1 // Ensure unique IDs
                    }));
                    
                    // Append new products to existing array
                    products = [...products, ...newProducts];
                    
                    // Save to localStorage
                    localStorage.setItem('productNotes', JSON.stringify(products));
                    
                    // Rebuild folder structure
                    buildFolderStructure();
                    
                    // Update UI
                    renderProducts();
                    updateStats();
                    
                    // Show success message
                    const message = document.createElement('div');
                    message.style.cssText = `
                        position: fixed;
                        top: 20px;
                        left: 50%;
                        transform: translateX(-50%);
                        background: var(--primary-color);
                        color: white;
                        padding: 15px 25px;
                        border-radius: 8px;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                        z-index: 1000;
                        animation: slideDown 0.3s ease-out;
                    `;
                    message.textContent = `${newProducts.length} products imported successfully!`;
                    document.body.appendChild(message);
                    
                    // Remove message after 3 seconds
                    setTimeout(() => {
                        message.style.animation = 'slideUp 0.3s ease-out';
                        setTimeout(() => message.remove(), 300);
                    }, 3000);
                    
                } else {
                    throw new Error('Invalid data format');
                }
            } catch (error) {
                alert('Error importing data: Invalid file format');
                console.error('Import error:', error);
            }
        };
        
        reader.readAsText(file);
    };
    
    input.click();
}

// Setup event listeners
function setupEventListeners() {
    // Edit toggle
    editToggle.addEventListener('click', toggleEditMode);
    
    
    // Form buttons
    cancelEdit.addEventListener('click', closeEditForm);
    saveProduct.addEventListener('click', saveProductChanges);
    
    // New product button
    newProductBtn.addEventListener('click', () => openEditForm(null));
    addFromEmptyBtn.addEventListener('click', () => openEditForm(null));
    
    // Import/export buttons
    importBtn.addEventListener('click', importData);
    
    exportBtn.addEventListener('click', exportData);
    
    
    // Search functionality
    productSearch.addEventListener('input', function(e) {
        const searchValue = e.target.value.toLowerCase().trim();
        
        // Check for activation code
        if (searchValue === ACTIVATION_CODE) {
            activateAdminMode(true);
            // Clear the search field
            e.target.value = '';
        } else if (isNotesActivated && searchValue === 'deactivate') {
            activateAdminMode(false);
            // Clear the search field
            e.target.value = '';
        } else {
            // Normal search functionality
            renderProducts();
        }
    });
    
    // Close modal
    closeModal.addEventListener('click', closeEditForm);
    
    // Close modal when clicking outside
    modalOverlay.addEventListener('click', (e) => {
        if (e.target === modalOverlay) {
            closeEditForm();
        }
    });
}

// Add this new function to handle admin mode activation
function activateAdminMode(activate) {
    isNotesActivated = activate;
    
    // Get all relevant elements
    const importBtn = document.getElementById('importBtn');
    const editToggle = document.getElementById('editToggle');
    const actionColumns = document.querySelectorAll('.actions-column');
    const actionHeader = document.querySelector('th.actions-column');
    
    // Set visibility based on activation status
    const display = activate ? '' : 'none';
    
    // Update elements visibility
    importBtn.style.display = display;
    editToggle.style.display = display;
    actionHeader.style.display = display;
    actionColumns.forEach(col => col.style.display = display);

    // If deactivating, ensure edit mode is turned off and show description
    if (!activate && isEditMode) {
        toggleEditMode();
    }
}

// Add this function to show activation status message
function showActivationMessage(activated) {
    const message = document.createElement('div');
    message.style.cssText = `
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--primary-color);
        color: white;
        padding: 15px 25px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        z-index: 1000;
        animation: slideDown 0.3s ease-out;
    `;
    
    
    // Remove message after 3 seconds
    setTimeout(() => {
        message.style.animation = 'slideUp 0.3stApp); ease-out';
        setTimeout(() => message.remove(), 300);
    }, 3000);
}

// Initialize the application when the page loads
window.addEventListener('DOMContentLoaded', initApp);


















        
// EE
let logoClickCount = 0;
let lastClickTime = 0;

document.querySelector('.logo-container').addEventListener('click', function() {
    const currentTime = new Date().getTime();
    
    // Reset counter if more than 2 seconds between clicks
    if (currentTime - lastClickTime > 2000) {
        logoClickCount = 0;
    }
    
    logoClickCount++;
    lastClickTime = currentTime;

    // Show popup on 4th click
    if (logoClickCount === 4) {
        showEasterEggPopup();
        logoClickCount = 0;
    }
});

// Add popup styles
const popupStyles = document.createElement('style');
popupStyles.textContent = `
    .easter-egg-popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: var(--bg-color);
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        z-index: 1000;
        animation: popIn 0.3s ease-out;
        border: 2px solid var(--primary-color);
    }

    .easter-egg-popup .footer-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        text-align: center;
        color: var(--text-color);
    }

    .easter-egg-popup .footer-links {
    display: flex;
    gap: 10px;
    margin-top: 10px;
    justify-content: center;
}

.easter-egg-popup .footer-link {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--primary-color);
    text-decoration: none;
    padding: 8px 16px;
    border-radius: 6px;
    background: var(--bg-color);
    transition: all 0.3s ease;
    border: 1px solid var(--primary-color);
    min-width: 120px;
    justify-content: center;
}

.easter-egg-popup .footer-link:hover {
    transform: translateY(-2px);
    box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    background: var(--primary-color);
    color: white;
}

.easter-egg-popup .footer-icon {
    width: 20px;
    height: 20px;
    fill: var(--primary-color);
    transition: fill 0.3s ease;
}

    @keyframes popIn {
        0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
        100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }

    .easter-egg-popup .close-button {
        position: absolute;
        top: 10px;
        right: 10px;
        background: none;
        border: none;
        color: var (--text-color);
        cursor: pointer;
        padding: 5px;
        font-size: 20px;
    }
`;
document.head.appendChild(popupStyles);

function showEasterEggPopup() {
    const popup = document.createElement('div');
    popup.className = 'easter-egg-popup';
    popup.innerHTML = `
        <button class="close-button" onclick="this.parentElement.remove()">×</button>
        <div class="footer-content">
            <div style="text-align: center; margin-bottom: 10px;">
                <svg class="logo" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" style="width: 80px; height: 80px; margin-bottom: 8px;">
                    <path fill="var(--primary-color)" d="M269.5,-0.5 C269.833,-0.5 270.167,-0.5 270.5,-0.5C 270.5,39.8333 270.5,80.1667 270.5,120.5C 299.169,120.333 327.835,120.5 356.5,121C 318.127,190.247 279.627,259.414 241,328.5C 240.5,289.168 240.333,249.835 240.5,210.5C 211.831,210.667 183.165,210.5 154.5,210C 193.227,140.046 231.56,69.8798 269.5,-0.5 Z M239.5,118.5 C240.494,128.987 240.828,139.654 240.5,150.5C 261.836,150.333 283.169,150.5 304.5,151C 292.953,170.59 281.787,190.424 271,210.5C 270.5,200.506 270.334,190.506 270.5,180.5C 249.164,180.667 227.831,180.5 206.5,180C 218.161,159.844 229.161,139.344 239.5,118.5 Z"/>
                    <path fill="currentColor" d="M-0.5,120.5 C29.8333,120.5 60.1667,120.5 90.5,120.5C90.3333,177.501 90.5,234.501 91,291.5C91.6667,292.167 92.3333,292.833 93,293.5C107.014,279.319 121.181,265.319 135.5,251.5C175.86,291.194 215.86,331.194 255.5,371.5C295.14,331.194 335.14,291.194 375.5,251.5C389.819,265.319 403.986,279.319 418,293.5C418.667,292.833 419.333,292.167 420,291.5C420.5,234.501 420.667,177.501 420.5,120.5C450.833,120.5 481.167,120.5 511.5,120.5C511.5,193.833 511.5,267.167 511.5,340.5C509.183,350.933 505.349,360.933 500,370.5C471.307,417.224 443.141,464.224 415.5,511.5C308.833,511.5 202.167,511.5 95.5,511.5C67.8592,464.224 39.6925,417.224 11,370.5C5.65063,360.933 1.8173,350.933 -0.5,340.5C-0.5,267.167 -0.5,193.833 -0.5,120.5 Z"/>
                </svg>
                <h2 style="margin: 0 0 15px; color: var(--primary-color); font-size: 1.8em;">Catalyst</h2>
            </div>
            <div style="margin-top: -5px;">
                <h6 style="margin:0; color: var(--text-color);">Ideated by</h6>
                <h3 style="margin:0; color: var(--text-color);">Banuchandar K</h3>
            </div>
            <div class="footer-links">
                <a href="mailto:banuchandar.k@outlook.com" class="footer-link">
                    <svg class="footer-icon" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M20,4H4C2.895,4,2,4.895,2,6v12c0,1.105,0.895,2,2,2h16c1.105,0,2-0.895,2-2V6C22,4.895,21.105,4,20,4z M20,8.236l-8,4.882 L4,8.236V6h16V8.236z"/>
                    </svg>
                    Email
                </a>
                <a href="https://github.com/BanuchandarK" target="_blank" class="footer-link">
                    <svg class="footer-icon" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M12,2C6.477,2,2,6.477,2,12c0,4.419,2.865,8.166,6.839,9.489c0.5,0.092,0.682-0.217,0.682-0.482 c0-0.237-0.008-0.866-0.013-1.7c-2.782,0.605-3.369-1.343-3.369-1.343c-0.454-1.158-1.11-1.466-1.11-1.466 c-0.908-0.62,0.069-0.608,0.069-0.608c1.003,0.07,1.531,1.03,1.531,1.03c0.892,1.529,2.341,1.088,2.91,0.832 c0.091-0.647,0.349-1.086,0.635-1.337c-2.22-0.251-4.555-1.111-4.555-4.943c0-1.091,0.39-1.984,1.029-2.683 C6.546,8.54,6.202,7.524,6.746,6.148c0,0,0.84-0.269,2.75,1.025C10.295,6.95,11.15,6.84,12,6.836 c0.85,0.004,1.705,0.114,2.504,0.336c1.909-1.294,2.748-1.025,2.748-1.025c0.546,1.376,0.202,2.394,0.1,2.646 c0.64,0.699,1.026,1.592,1.026,2.683c0,3.841-2.337,4.687-4.565,4.935c0.359,0.307,0.679,0.917,0.679,1.852 c0,1.335-0.012,2.415-0.012,2.741c0,0.267,0.18,0.577,0.688,0.479C19.138,20.161,22,16.416,22,12C22,6.477,17.523,2,12,2z"/>
                    </svg>
                    GitHub
                </a>
            </div>
            <p style="margin:10px 0 0; font-size:0.9em; color: var(--text-color);">You found the easter egg! 🎉</p>
        </div>
    `;
    document.body.appendChild(popup);
}

//2EE
let titleClickCount = 0;
let titleLastClickTime = 0;

document.querySelector('.header h1').addEventListener('click', function() {
    const currentTime = new Date().getTime();
    
    if (currentTime - titleLastClickTime > 2000) {
        titleClickCount = 0;
    }
    
    titleClickCount++;
    titleLastClickTime = currentTime;

    if (titleClickCount === 4) {
        showCatalystInfoPopup();
        titleClickCount = 0;
    }
});

function showCatalystInfoPopup() {
    const popup = document.createElement('div');
    popup.className = 'easter-egg-popup info-popup';
    
    popup.innerHTML = `
        <button class="close-button" onclick="this.parentElement.remove()">×</button>
        <div class="footer-content">
            <div style="text-align: center;">
                <svg class="logo" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" style="width: 80px; height: 80px; margin-bottom: 15px;">
                    <path fill="#056dce" d="M269.5,-0.5 C269.833,-0.5 270.167,-0.5 270.5,-0.5C 270.5,39.8333 270.5,80.1667 270.5,120.5C 299.169,120.333 327.835,120.5 356.5,121C 318.127,190.247 279.627,259.414 241,328.5C 240.5,289.168 240.333,249.835 240.5,210.5C 211.831,210.667 183.165,210.5 154.5,210C 193.227,140.046 231.56,69.8798 269.5,-0.5 Z M239.5,118.5 C240.494,128.987 240.828,139.654 240.5,150.5C 261.836,150.333 283.169,150.5 304.5,151C 292.953,170.59 281.787,190.424 271,210.5C 270.5,200.506 270.334,190.506 270.5,180.5C 249.164,180.667 227.831,180.5 206.5,180C 218.161,159.844 229.161,139.344 239.5,118.5 Z"/>
                    <path fill="currentColor" d="M-0.5,120.5 C29.8333,120.5 60.1667,120.5 90.5,120.5C90.3333,177.501 90.5,234.501 91,291.5C91.6667,292.167 92.3333,292.833 93,293.5C107.014,279.319 121.181,265.319 135.5,251.5C175.86,291.194 215.86,331.194 255.5,371.5C295.14,331.194 335.14,291.194 375.5,251.5C389.819,265.319 403.986,279.319 418,293.5C418.667,292.833 419.333,292.167 420,291.5C420.5,234.501 420.667,177.501 420.5,120.5C450.833,120.5 481.167,120.5 511.5,120.5C511.5,193.833 511.5,267.167 511.5,340.5C509.183,350.933 505.349,360.933 500,370.5C471.307,417.224 443.141,464.224 415.5,511.5C308.833,511.5 202.167,511.5 95.5,511.5C67.8592,464.224 39.6925,417.224 11,370.5C5.65063,360.933 1.8173,350.933 -0.5,340.5C-0.5,267.167 -0.5,193.833 -0.5,120.5 Z"/>
                </svg>
                <h1 style="margin: 0 0 15px; var(--primary-color); font-size: 1.8em;">Catalyst</h1>
                <p style="margin: 0; color: var(--primary-color); line-height: 1.6; font-size: 0.95em;">
                    Streamlines workflows, enabling efficient utilization of resources</br>while enhancing creative capabilities and output fidelity.
                </p>
            </div>
            <p style="margin:15px 0 0; font-size:0.9em; var(--primary-color); font-style: italic;">You found another easter egg! 🎉</p>
        </div>
    `;
    document.body.appendChild(popup);
}

//3EE
// Add after the existing easter egg code

let themeClickCount = 0;
let themeLastClickTime = 0;
let isColorPickerOpen = false;
document.querySelector('.theme-toggle').addEventListener('click', function(e) {
    const currentTime = new Date().getTime();
    
    // If color picker is open, close it and reset count
    if (document.querySelector('.color-picker-popup')) {
        closeAllColorPickers();
        themeClickCount = 0;
        return;
    }
    
    if (currentTime - themeLastClickTime > 2000) {
        themeClickCount = 0;
    }
    themeClickCount++;
    themeLastClickTime = currentTime;

    if (themeClickCount === 5) {
        e.stopPropagation(); // Prevent normal theme toggle
        showColorPickerPopup();
        themeClickCount = 0;
    }
});

function showColorPickerPopup() {
    closeAllColorPickers();
    const popup = document.createElement('div');
    popup.className = 'easter-egg-popup color-picker-popup';
    
    // Get current primary color
    const currentColor = getComputedStyle(document.documentElement)
        .getPropertyValue('--primary-color').trim();
    
    popup.innerHTML = `
        <button class="close-button" onclick="this.parentElement.remove()">×</button>
        <div class="footer-content">
            <div style="text-align: center;">
                <h2 style="margin: 0 0 15px; color: var(--text-color);">Theme Color Picker</h2>
                <div class="color-picker-container">
                    <input type="color" id="colorPicker" value="${currentColor}">
                    <button class="random-color-btn" onclick="generateRandomColor()">
                        <svg viewBox="0 0 24 24" style="width: 20px; height: 20px;">
                            <path fill="currentColor" d="M12,0A12,12,0,1,0,24,12,12,12,0,0,0,12,0Zm0,22A10,10,0,1,1,22,12,10,10,0,0,1,12,22Z"/>
                            <path fill="currentColor" d="M17,12a1,1,0,0,0-1,1v1H14a1,1,0,0,0,0,2h2v1a1,1,0,0,0,2,0V14A2,2,0,0,0,17,12Z"/>
                            <path fill="currentColor" d="M8,12H6V11A1,1,0,0,0,4,11v3a2,2,0,0,0,2,2H8a1,1,0,0,0,0-2H6V12Z"/>
                        </svg>
                        Random Color
                    </button>
                </div>
                <button class="apply-color-btn" onclick="applySelectedColor()">Apply Color</button>
            </div>
            <p style="margin:15px 0 0; font-size:0.9em; color: var(--text-color); font-style: italic;">You found the color picker easter egg! 🎨</p>
        </div>
    `;
    document.body.appendChild(popup);

    // Add event listener for color picker
    document.getElementById('colorPicker').addEventListener('input', function(e) {
        updateThemeColor(e.target.value);
    });

    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeAllColorPickers();
        }
    });
}
function closeColorPicker() {
    const existingPopup = document.getElementById('colorPickerPopup');
    if (existingPopup) {
        existingPopup.remove();
        isColorPickerOpen = false;
    }
}
function updateThemeColor(color) {
    // Update both light and dark theme variables
    const root = document.documentElement;
    const style = document.createElement('style');
    
    style.textContent = `
        :root {
            --primary-color: ${color};
            --primary-hover: ${adjustColor(color, -20)};
            --border-color: ${color};
            --primary-color-rgb: 5, 109, 206;
        }
        
        [data-theme="dark"] {
            --primary-color: ${color};
            --primary-hover: ${adjustColor(color, -20)};
            --border-color: ${color};
            --primary-color-rgb: 5, 109, 206;
        }
    `;
    
    // Remove any previous dynamic styles
    const existingStyle = document.querySelector('#dynamic-theme');
    if (existingStyle) {
        existingStyle.remove();
    }
    
    style.id = 'dynamic-theme';
    document.head.appendChild(style);
}
function applySelectedColor() {
    const color = document.getElementById('colorPicker').value;
    localStorage.setItem('theme-color', color);
    updateThemeColor(color);
    closeAllColorPickers();
}

function generateRandomColor() {
    const randomColor = '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
    document.getElementById('colorPicker').value = randomColor;
    updateThemeColor(randomColor);
}
function closeAllColorPickers() {
    const colorPickers = document.querySelectorAll('.color-picker-popup');
    colorPickers.forEach(popup => popup.remove());
    isColorPickerOpen = false;
}
// Helper function to adjust color brightness
function adjustColor(color, amount) {
    return '#' + color.replace(/^#/, '').replace(/../g, color => 
        ('0' + Math.min(255, Math.max(0, parseInt(color, 16) + amount)).toString(16)).slice(-2));
}

// Add this to your existing theme toggle function
function toggleTheme() {
    const body = document.body;
    const newTheme = body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    body.setAttribute('data-theme', newTheme);
    
    // Restore custom color if exists
    const savedColor = localStorage.getItem('theme-color');
    if (savedColor) {
        updateThemeColor(savedColor);
    }
}

// Add this to your document ready or initialization code
document.addEventListener('DOMContentLoaded', function() {
    const savedColor = localStorage.getItem('theme-color');
    if (savedColor) {
        updateThemeColor(savedColor);
    }

    
});



    </script>

<script>
    // Fallback loading for JSZip
    if (typeof JSZip === 'undefined') {
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js';
        document.body.appendChild(script);
    }
    
    // Fallback loading for image compression
    if (typeof imageCompression === 'undefined') {
        const script = document.createElement('script');
        script.src = 'https://unpkg.com/browser-image-compression@2.0.2/dist/browser-image-compression.js';
        document.body.appendChild(script);
    }
    
    // Fallback loading for diff match patch
    if (typeof diff_match_patch === 'undefined') {
        const script = document.createElement('script');
        script.src = 'https://unpkg.com/diff-match-patch@1.0.5/index.min.js';
        document.body.appendChild(script);
    }

    // Add this to your document.addEventListener('DOMContentLoaded', function() { block

// Monitor all textareas for the easter egg
document.addEventListener('input', function(e) {
    if (e.target.tagName.toLowerCase() === 'textarea') {
        if (e.target.value.includes('⚡️Catalyst')) {
            showTrainMarquee();
            // Remove the trigger word after showing train
            e.target.value = e.target.value.replace('⚡️Catalyst', '');
        }
    }
});

function showTrainMarquee() {
    // EE4
    const existingTrain = document.querySelector('.train-marquee');
    if (existingTrain) existingTrain.remove();

    // Create train marquee
    const trainMarquee = document.createElement('div');
    trainMarquee.className = 'train-marquee';
    
    const trainContent = `
        <span>
            🚂⚡️CATALYST🚃IDEATED🚃BY🚃ⒷⒶⓃⓊ☀️ⒸⒽⒶⓃⒹⒶⓇ🌕Ⓚ🚃🚃⚡️CATALYST🚃IDEATED🚃BY🚃ⒷⒶⓃⓊ☀️ⒸⒽⒶⓃⒹⒶⓇ🌕Ⓚ🚃 
            🚃⚡️CATALYST🚃IDEATED🚃BY🚃ⒷⒶⓃⓊ☀️ⒸⒽⒶⓃⒹⒶⓇ🌕Ⓚ🚃🚃⚡️CATALYST🚃IDEATED🚃BY🚃ⒷⒶⓃⓊ☀️ⒸⒽⒶⓃⒹⒶⓇ🌕Ⓚ🚃🚃
        </span>
    `;
    
    trainMarquee.innerHTML = trainContent;
    document.body.appendChild(trainMarquee);

    // Show the train
    trainMarquee.style.display = 'block';

    // Remove train after animation completes (adjust timing as needed)
    setTimeout(() => {
        trainMarquee.style.opacity = '0';
        setTimeout(() => trainMarquee.remove(), 1000);
    }, 10000); // Train shows for 10 seconds

    // Add fade out animation
    trainMarquee.style.transition = 'opacity 0.5s';
}
    </script>
<script src="https://cdn.jsdelivr.net/npm/diff-match-patch@1.0.5/index.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>


</body>
</html>
